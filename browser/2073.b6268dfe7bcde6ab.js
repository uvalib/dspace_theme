(self.webpackChunkdspace_angular=self.webpackChunkdspace_angular||[]).push([[2073],{70379:(k,w,i)=>{"use strict";i.d(w,{S:()=>M});var T=i(54438),a=i(82777),t=i(30506),g=i(7673),S=i(90839);let E=(()=>{class x{getBreadcrumbs(_,d){return(0,g.of)([new S.Q(_+".breadcrumbs",d)])}static{this.\u0275fac=function(d){return new(d||x)}}static{this.\u0275prov=T.jDH({token:x,factory:x.\u0275fac,providedIn:"root"})}}return x})();const M=(x,P,_=(0,T.WQX)(E))=>{const d=x.data.breadcrumbKey;if((0,a.Tn)(d))throw new Error('You provided an i18nBreadcrumbResolver for url "'+x.url+"\" but no breadcrumbKey in the route's data");return{provider:_,key:d,url:(0,t.F)(x)}}},24591:(k,w,i)=>{"use strict";i.d(w,{t:()=>x});var T=i(52717),a=i(60177),t=i(54438),S=(i(76829),i(27656)),y=i(80987),E=i(28043);function M(P,_){if(1&P){const d=t.RV6();t.j41(0,"ds-dso-edit-metadata-value",3),t.bIt("edit",function(){const u=t.eBV(d).$implicit;return t.Njj(u.editing=!0)})("confirm",function(u){const v=t.eBV(d).$implicit,O=t.XpG();return v.confirmChanges(u),O.form.resetReinstatable(),t.Njj(O.valueSaved.emit())})("remove",function(){const u=t.eBV(d),v=u.$implicit,O=u.index,V=t.XpG();return v.change===V.DsoEditMetadataChangeTypeEnum.ADD?V.form.remove(V.mdField,O):v.change=V.DsoEditMetadataChangeTypeEnum.REMOVE,V.form.resetReinstatable(),t.Njj(V.valueSaved.emit())})("undo",function(){const u=t.eBV(d),v=u.$implicit,O=u.index,V=t.XpG();return v.change===V.DsoEditMetadataChangeTypeEnum.ADD?V.form.remove(V.mdField,O):v.discard(),t.Njj(V.valueSaved.emit())})("dragging",function(u){t.eBV(d);const v=t.XpG();return t.Njj(v.draggingMdField$.next(u?v.mdField:null))}),t.k0s()}if(2&P){const d=_.$implicit,l=t.XpG();t.Y8G("dso",l.dso)("mdValue",d)("mdField",l.mdField)("dsoType",l.dsoType)("saving$",l.saving$)("isOnlyValue",1===l.form.fields[l.mdField].length)}}let x=(()=>{class P{constructor(){this.valueSaved=new t.bkB,this.DsoEditMetadataChangeTypeEnum=S.QR}drop(d){(0,T.HD)(this.form.fields[this.mdField],d.previousIndex,d.currentIndex),this.form.fields[this.mdField].forEach((v,O)=>{v.newValue.place=O,v.confirmChanges()}),this.form.resetReinstatable(),this.valueSaved.emit()}static{this.\u0275fac=function(l){return new(l||P)}}static{this.\u0275cmp=t.VBU({type:P,selectors:[["ds-dso-edit-metadata-field-values"]],inputs:{dso:"dso",form:"form",mdField:"mdField",dsoType:"dsoType",saving$:"saving$",draggingMdField$:"draggingMdField$"},outputs:{valueSaved:"valueSaved"},standalone:!0,features:[t.aNF],decls:5,vars:8,consts:[["cdkDropList","","role","table",1,"flex-grow-1","ds-drop-list","h-100",3,"cdkDropListDropped"],["role","presentation",3,"dsoType"],["role","presentation",3,"dso","mdValue","mdField","dsoType","saving$","isOnlyValue","edit","confirm","remove","undo","dragging",4,"ngFor","ngForOf"],["role","presentation",3,"edit","confirm","remove","undo","dragging","dso","mdValue","mdField","dsoType","saving$","isOnlyValue"]],template:function(l,u){1&l&&(t.j41(0,"div",0),t.nI1(1,"async"),t.nI1(2,"async"),t.bIt("cdkDropListDropped",function(O){return u.drop(O)}),t.nrm(3,"ds-dso-edit-metadata-value-headers",1),t.DNE(4,M,1,6,"ds-dso-edit-metadata-value",2),t.k0s()),2&l&&(t.AVh("disabled",t.bMT(1,4,u.draggingMdField$)&&t.bMT(2,6,u.draggingMdField$)!==u.mdField),t.R7$(3),t.Y8G("dsoType",u.dsoType),t.R7$(),t.Y8G("ngForOf",u.form.fields[u.mdField]))},dependencies:[T.O7,E.c,a.pM,y.o,a.Jj],styles:[".ds-drop-list[_ngcontent-%COMP%]{background-color:var(--bs-gray-500)}.ds-drop-list.disabled[_ngcontent-%COMP%]{opacity:.3}"]})}}return P})()},27656:(k,w,i)=>{"use strict";i.d(w,{QR:()=>M,qf:()=>P});class T{constructor(d,l){this.op=d,this.field=l}}let a=(()=>{class _ extends T{static{this.operationType="add"}constructor(l,u){super(_.operationType,l),this.value=u}toOperation(){return{op:this.op,path:`/metadata/${this.field}/-`,value:this.value}}}return _})(),t=(()=>{class _ extends T{static{this.operationType="move"}constructor(l,u,v){super(_.operationType,l),this.from=u,this.to=v}toOperation(){return{op:this.op,from:`/metadata/${this.field}/${this.from}`,path:`/metadata/${this.field}/${this.to}`}}}return _})(),g=(()=>{class _ extends T{static{this.operationType="remove"}constructor(l,u){super(_.operationType,l),this.place=u}toOperation(){return{op:this.op,path:`/metadata/${this.field}/${this.place}`}}}return _})(),S=(()=>{class _ extends T{static{this.operationType="replace"}constructor(l,u,v){super(_.operationType,l),this.place=u,this.value=v}toOperation(){return{op:this.op,path:`/metadata/${this.field}/${this.place}`,value:this.value}}}return _})();var y=i(14391),E=i(82777),M=function(_){return _[_.UPDATE=1]="UPDATE",_[_.ADD=2]="ADD",_[_.REMOVE=3]="REMOVE",_}(M||{});class x{constructor(d,l=!1){this.editing=!1,this.reordered=!1,this.originalValue=d,this.newValue=Object.assign(new y.vD,d),l&&(this.change=M.ADD,this.editing=!0)}confirmChanges(d=!1){this.reordered=this.originalValue.place!==this.newValue.place,((0,E.Tn)(this.change)||this.change===M.UPDATE)&&(this.change=this.originalValue.value!==this.newValue.value||this.originalValue.language!==this.newValue.language||this.originalValue.authority!==this.newValue.authority||this.originalValue.confidence!==this.newValue.confidence?M.UPDATE:void 0),d&&(this.editing=!1)}hasChanges(){return(0,E.a4)(this.change)||this.reordered}discardAndMarkReinstatable(){(this.change===M.UPDATE||this.reordered)&&(this.reinstatableValue=this.newValue),this.reinstatableChange=this.change,this.discard(!1)}discard(d=!0){this.change=void 0;const l=this.newValue.place;this.newValue=Object.assign(new y.vD,this.originalValue),d&&(this.newValue.place=l),this.confirmChanges(!0)}reinstate(){(0,E.a4)(this.reinstatableValue)&&(this.newValue=this.reinstatableValue,this.reinstatableValue=void 0),(0,E.a4)(this.reinstatableChange)&&(this.change=this.reinstatableChange,this.reinstatableChange=void 0),this.confirmChanges()}isReinstatable(){return(0,E.a4)(this.reinstatableValue)||(0,E.a4)(this.reinstatableChange)}resetReinstatable(){this.reinstatableValue=void 0,this.reinstatableChange=void 0}}class P{constructor(d){this.originalFieldKeys=[],this.fieldKeys=[],this.fields={},this.reinstatableNewValues={},Object.entries(d).forEach(([l,u])=>{this.originalFieldKeys.push(l),this.fieldKeys.push(l),this.setValuesForFieldSorted(l,u.map(v=>new x(v)))}),this.sortFieldKeys()}add(){(0,E.Tn)(this.newValue)&&(this.newValue=new x(new y.vD,!0))}setMetadataField(d){this.newValue.editing=!1,this.addValueToField(this.newValue,d);const l=this.fields[d].length-1;this.fields[d][l].originalValue.place=l,this.fields[d][l].newValue.place=l,this.newValue=void 0}addValueToField(d,l){(0,E.Im)(this.fields[l])&&(this.fieldKeys.push(l),this.sortFieldKeys(),this.fields[l]=[]),this.fields[l].push(d)}remove(d,l){(0,E.hj)(this.fields[d])&&(this.fields[d].splice(l,1),0===this.fields[d].length&&(this.fieldKeys.splice(this.fieldKeys.indexOf(d),1),delete this.fields[d]))}hasChanges(){return Object.values(this.fields).some(d=>d.some(l=>l.hasChanges()))}hasOrderChanges(d){return this.fields[d].some(l=>l.originalValue.place!==l.newValue.place)}discard(){this.resetReinstatable(),Object.entries(this.fields).forEach(([d,l])=>{let u=-1;l.forEach((v,O)=>{v.change===M.ADD?((0,E.Im)(this.reinstatableNewValues[d])&&(this.reinstatableNewValues[d]=[]),this.reinstatableNewValues[d].push(v),-1===u&&(u=O)):v.discardAndMarkReinstatable()}),u>-1&&this.fields[d].splice(u,this.fields[d].length-u)}),this.fieldKeys.forEach(d=>{this.originalFieldKeys.indexOf(d)<0&&delete this.fields[d]}),this.fieldKeys=[...this.originalFieldKeys],this.sortFieldKeys(),this.fieldKeys.forEach(d=>{this.setValuesForFieldSorted(d,this.fields[d])})}resetOrder(d){this.fields[d].forEach(l=>{l.newValue.place=l.originalValue.place,l.confirmChanges()}),this.setValuesForFieldSorted(d,this.fields[d])}sortFieldKeys(){this.fieldKeys.sort((d,l)=>d.localeCompare(l))}reinstate(){Object.values(this.fields).forEach(d=>{d.forEach(l=>{l.reinstate()})}),Object.entries(this.reinstatableNewValues).forEach(([d,l])=>{l.forEach(u=>{this.addValueToField(u,d)})}),this.fieldKeys.forEach(d=>{this.setValuesForFieldSorted(d,this.fields[d])}),this.reinstatableNewValues={}}isReinstatable(){return(0,E.hj)(this.reinstatableNewValues)||Object.values(this.fields).some(d=>d.some(l=>l.isReinstatable()))}resetReinstatable(){this.reinstatableNewValues={},Object.values(this.fields).forEach(d=>{d.forEach(l=>{l.resetReinstatable()})})}setValuesForFieldSorted(d,l){this.fields[d]=l.sort((u,v)=>u.newValue.place-v.newValue.place)}getOperations(d){const l=[];return Object.entries(this.fields).forEach(([u,v])=>{const O=[],V=[],R=[];[...v].sort((h,L)=>h.originalValue.place-L.originalValue.place).forEach(h=>{(0,E.a4)(h.change)&&(h.change===M.UPDATE?(h.originalValue.value!==h.newValue.value||h.originalValue.language!==h.newValue.language||h.originalValue.authority!==h.newValue.authority||h.originalValue.confidence!==h.newValue.confidence)&&O.push(new S(u,h.originalValue.place,{value:h.newValue.value,language:h.newValue.language,authority:h.newValue.authority,confidence:h.newValue.confidence})):h.change===M.REMOVE?V.push(new g(u,h.originalValue.place)):h.change===M.ADD?R.push(new a(u,{value:h.newValue.value,language:h.newValue.language,authority:h.newValue.authority,confidence:h.newValue.confidence})):console.warn("Illegal metadata change state detected for",h))}),l.push(...O.map(h=>h.toOperation())),l.push(...V.sort((h,L)=>L.place-h.place).map(h=>h.toOperation())),l.push(...R.map(h=>h.toOperation()))}),Object.entries(this.fields).forEach(([u,v])=>{const O=v.filter(R=>R.change!==M.REMOVE),V=d.diff([...O].sort((R,h)=>R.originalValue.place-h.originalValue.place).map(R=>R.originalValue.place),[...O].sort((R,h)=>R.newValue.place-h.newValue.place).map(R=>R.originalValue.place)).map(R=>new t(u,+R.from.substr(1),+R.path.substr(1)).toOperation());l.push(...V)}),l}}},40659:(k,w,i)=>{"use strict";i.d(w,{L:()=>t});var T=i(41780),a=i(54438);let t=(()=>{class g{static{this.\u0275fac=function(E){return new(E||g)}}static{this.\u0275cmp=a.VBU({type:g,selectors:[["ds-dso-edit-metadata-headers"]],inputs:{dsoType:"dsoType"},standalone:!0,features:[a.aNF],decls:18,vars:12,consts:[[1,"d-flex","flex-row","ds-field-row","ds-header-row"],[1,"lbl-cell"],[1,"flex-grow-1"],[1,"d-flex","flex-row"],[1,"flex-grow-1","ds-flex-cell","ds-value-cell"],[1,"dont-break-out","preserve-line-breaks"],[1,"ds-flex-cell","ds-lang-cell"],[1,"text-center","ds-flex-cell","ds-edit-cell"]],template:function(E,M){1&E&&(a.j41(0,"div",0)(1,"div",1),a.EFF(2),a.nI1(3,"translate"),a.k0s(),a.j41(4,"div",2)(5,"div",3)(6,"div",4)(7,"b",5),a.EFF(8),a.nI1(9,"translate"),a.k0s()(),a.j41(10,"div",6)(11,"b"),a.EFF(12),a.nI1(13,"translate"),a.k0s()(),a.j41(14,"div",7)(15,"b"),a.EFF(16),a.nI1(17,"translate"),a.k0s()()()()()),2&E&&(a.R7$(2),a.JRh(a.bMT(3,4,M.dsoType+".edit.metadata.headers.field")),a.R7$(6),a.JRh(a.bMT(9,6,M.dsoType+".edit.metadata.headers.value")),a.R7$(4),a.JRh(a.bMT(13,8,M.dsoType+".edit.metadata.headers.language")),a.R7$(4),a.JRh(a.bMT(17,10,M.dsoType+".edit.metadata.headers.edit")))},dependencies:[T.h,T.D9],styles:[".lbl-cell[_ngcontent-%COMP%]{min-width:var(--ds-dso-edit-field-width);max-width:var(--ds-dso-edit-field-width);background-color:var(--bs-gray-100);font-weight:700;padding:1rem;border:1px solid var(--bs-gray-200)}.ds-header-row[_ngcontent-%COMP%]{background-color:var(--bs-gray-100)}",".ds-field-row[_ngcontent-%COMP%]{border:1px solid var(--bs-gray-400)}.ds-flex-cell[_ngcontent-%COMP%]{padding:1rem;border:1px solid var(--bs-gray-200)}.ds-lang-cell[_ngcontent-%COMP%]{min-width:var(--ds-dso-edit-lang-width);max-width:var(--ds-dso-edit-lang-width)}.ds-edit-cell[_ngcontent-%COMP%]{min-width:var(--ds-dso-edit-actions-width)}.ds-value-row[_ngcontent-%COMP%]{background-color:#fff}.ds-value-row[_ngcontent-%COMP%]:active{cursor:grabbing}.ds-value-row.ds-warning[_ngcontent-%COMP%]{background-color:var(--ds-warning-bg)}.ds-value-row.ds-warning[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-warning)}.ds-value-row.ds-danger[_ngcontent-%COMP%]{background-color:var(--ds-danger-bg)}.ds-value-row.ds-danger[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-danger)}.ds-value-row.ds-success[_ngcontent-%COMP%]{background-color:var(--ds-success-bg)}.ds-value-row.ds-success[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-success)}"]})}}return g})()},28043:(k,w,i)=>{"use strict";i.d(w,{c:()=>t});var T=i(41780),a=i(54438);let t=(()=>{class g{static{this.\u0275fac=function(E){return new(E||g)}}static{this.\u0275cmp=a.VBU({type:g,selectors:[["ds-dso-edit-metadata-value-headers"]],inputs:{dsoType:"dsoType"},standalone:!0,features:[a.aNF],decls:10,vars:9,consts:[["role","row",1,"visually-hidden"],["role","columnheader"]],template:function(E,M){1&E&&(a.j41(0,"div",0)(1,"div",1),a.EFF(2),a.nI1(3,"translate"),a.k0s(),a.j41(4,"div",1),a.EFF(5),a.nI1(6,"translate"),a.k0s(),a.j41(7,"div",1),a.EFF(8),a.nI1(9,"translate"),a.k0s()()),2&E&&(a.R7$(2),a.JRh(a.bMT(3,3,M.dsoType+".edit.metadata.headers.value")),a.R7$(3),a.JRh(a.bMT(6,5,M.dsoType+".edit.metadata.headers.language")),a.R7$(3),a.JRh(a.bMT(9,7,M.dsoType+".edit.metadata.headers.edit")))},dependencies:[T.h,T.D9],styles:[".ds-field-row[_ngcontent-%COMP%]{border:1px solid var(--bs-gray-400)}.ds-flex-cell[_ngcontent-%COMP%]{padding:1rem;border:1px solid var(--bs-gray-200)}.ds-lang-cell[_ngcontent-%COMP%]{min-width:var(--ds-dso-edit-lang-width);max-width:var(--ds-dso-edit-lang-width)}.ds-edit-cell[_ngcontent-%COMP%]{min-width:var(--ds-dso-edit-actions-width)}.ds-value-row[_ngcontent-%COMP%]{background-color:#fff}.ds-value-row[_ngcontent-%COMP%]:active{cursor:grabbing}.ds-value-row.ds-warning[_ngcontent-%COMP%]{background-color:var(--ds-warning-bg)}.ds-value-row.ds-warning[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-warning)}.ds-value-row.ds-danger[_ngcontent-%COMP%]{background-color:var(--ds-danger-bg)}.ds-value-row.ds-danger[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-danger)}.ds-value-row.ds-success[_ngcontent-%COMP%]{background-color:var(--ds-success-bg)}.ds-value-row.ds-success[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-success)}"]})}}return g})()},80987:(k,w,i)=>{"use strict";i.d(w,{o:()=>mt});var T=i(52717),a=i(60177),t=i(54438),g=i(89417),S=i(7901),y=i(52149),E=i(41780),M=i(84412),x=i(983),P=i(7673),_=i(96354),d=i(25558),l=i(88141),u=i(96697),v=i(67558),O=i(19506),V=i(39806),R=i(96526),h=i(29326),L=i(48833),Q=i(5410),A=i(98179),J=(i(76829),i(85448)),U=i(80183),e=i(90887),z=i(60456),G=i(82777),Z=i(18302),q=i(45500),I=i(83766),X=i(11220),b=i(61280),D=i(39729),C=i(74448),B=i(56386),K=i(67600),tt=i(18226),at=i(27656);const nt=(c,F,n,o)=>({"ds-warning":c,"ds-danger":F,"ds-success":n,"h-100":o}),f=c=>({disabled:c});function N(c,F){if(1&c&&(t.j41(0,"div",25),t.EFF(1),t.k0s()),2&c){const n=t.XpG(3);t.R7$(),t.JRh(n.mdValue.newValue.value)}}function s(c,F){if(1&c){const n=t.RV6();t.j41(0,"textarea",26),t.nI1(1,"translate"),t.mxI("ngModelChange",function(r){t.eBV(n);const j=t.XpG(3);return t.DH7(j.mdValue.newValue.value,r)||(j.mdValue.newValue.value=r),t.Njj(r)}),t.bIt("onDebounce",function(){t.eBV(n);const r=t.XpG(3);return t.Njj(r.confirm.emit(!1))}),t.k0s()}if(2&c){const n=t.XpG(3);t.R50("ngModel",n.mdValue.newValue.value),t.Y8G("dsDebounce",300),t.BMQ("aria-label",t.bMT(1,3,n.dsoType+".edit.metadata.edit.value"))}}function m(c,F){if(1&c){const n=t.RV6();t.j41(0,"ds-dynamic-scrollable-dropdown",27),t.bIt("change",function(r){t.eBV(n);const j=t.XpG(3);return t.Njj(j.onChangeAuthorityField(r))}),t.k0s()}if(2&c){const n=t.XpG(3);t.Y8G("bindId",n.mdField)("group",n.group)("model",n.getModel())}}function p(c,F){if(1&c){const n=t.RV6();t.j41(0,"ds-dynamic-onebox",28),t.bIt("change",function(r){t.eBV(n);const j=t.XpG(3);return t.Njj(j.onChangeAuthorityField(r))}),t.k0s()}if(2&c){const n=t.XpG(3);t.Y8G("group",n.group)("model",n.getModel())}}function $(c,F){if(1&c){const n=t.RV6();t.j41(0,"button",29),t.nI1(1,"translate"),t.bIt("click",function(){t.eBV(n);const r=t.XpG(3);return t.Njj(r.toggleFreeTextEdition())}),t.nrm(2,"i",30),t.EFF(3),t.nI1(4,"translate"),t.k0s()}if(2&c){const n=t.XpG(3);t.Y8G("title",n.enabledFreeTextEditing?n.dsoType+".edit.metadata.edit.buttons.disable-free-text-editing":t.bMT(1,3,n.dsoType+".edit.metadata.edit.buttons.enable-free-text-editing")),t.R7$(2),t.Y8G("ngClass",n.enabledFreeTextEditing?"fa-lock":"fa-unlock"),t.R7$(),t.SpI(" ",t.bMT(4,5,n.enabledFreeTextEditing?n.dsoType+".edit.metadata.edit.buttons.disable-free-text-editing":n.dsoType+".edit.metadata.edit.buttons.enable-free-text-editing")," ")}}function W(c,F){if(1&c&&(t.j41(0,"div")(1,"span",31),t.nrm(2,"i",32),t.EFF(3),t.nI1(4,"translate"),t.k0s()()),2&c){const n=t.XpG(3);t.R7$(2),t.Y8G("authorityValue",n.mdValue.newValue)("iconMode",!0),t.R7$(),t.Lme(" ",t.bMT(4,4,n.dsoType+".edit.metadata.authority.label")," ",n.mdValue.newValue.authority," ")}}function Y(c,F){if(1&c){const n=t.RV6();t.j41(0,"button",39),t.nI1(1,"translate"),t.nI1(2,"translate"),t.bIt("click",function(){t.eBV(n);const r=t.XpG(4);return t.Njj(r.onChangeEditingAuthorityStatus(!0))}),t.nrm(3,"i",40),t.k0s()}if(2&c){const n=t.XpG(4);t.FS9("ngbTooltip",t.bMT(1,2,n.dsoType+".edit.metadata.edit.buttons.open-authority-edition")),t.Y8G("title",t.bMT(2,4,n.dsoType+".edit.metadata.edit.buttons.open-authority-edition"))}}function H(c,F){if(1&c){const n=t.RV6();t.j41(0,"button",41),t.nI1(1,"translate"),t.nI1(2,"translate"),t.bIt("click",function(){t.eBV(n);const r=t.XpG(4);return t.Njj(r.onChangeEditingAuthorityStatus(!1))}),t.nrm(3,"i",42),t.k0s()}if(2&c){const n=t.XpG(4);t.FS9("ngbTooltip",t.bMT(1,2,n.dsoType+".edit.metadata.edit.buttons.close-authority-edition")),t.Y8G("title",t.bMT(2,4,n.dsoType+".edit.metadata.edit.buttons.close-authority-edition"))}}function it(c,F){if(1&c){const n=t.RV6();t.j41(0,"div",33)(1,"div",34),t.nrm(2,"i",35),t.j41(3,"input",36),t.nI1(4,"translate"),t.mxI("ngModelChange",function(r){t.eBV(n);const j=t.XpG(3);return t.DH7(j.mdValue.newValue.authority,r)||(j.mdValue.newValue.authority=r),t.Njj(r)}),t.bIt("change",function(){t.eBV(n);const r=t.XpG(3);return t.Njj(r.onChangeAuthorityKey())}),t.k0s(),t.DNE(5,Y,4,6,"button",37)(6,H,4,6,"button",38),t.k0s()()}if(2&c){const n=t.XpG(3);t.R7$(2),t.Y8G("authorityValue",n.mdValue.newValue.confidence)("iconMode",!0),t.R7$(),t.R50("ngModel",n.mdValue.newValue.authority),t.Y8G("disabled",!n.editingAuthority),t.BMQ("aria-label",t.bMT(4,7,n.dsoType+".edit.metadata.edit.authority.key")),t.R7$(2),t.Y8G("ngIf",!n.editingAuthority),t.R7$(),t.Y8G("ngIf",n.editingAuthority)}}function st(c,F){if(1&c&&(t.j41(0,"div",43)(1,"a",44),t.nI1(2,"async"),t.EFF(3),t.nI1(4,"async"),t.k0s(),t.nrm(5,"ds-type-badge",45),t.k0s()),2&c){const n=t.XpG().ngVar,o=t.XpG(2);t.R7$(),t.Y8G("routerLink",t.bMT(2,3,o.mdRepresentationItemRoute$)),t.R7$(2),t.JRh(t.bMT(4,5,o.mdRepresentationName$)),t.R7$(2),t.Y8G("object",n)}}function dt(c,F){if(1&c&&(t.j41(0,"div",17),t.DNE(1,N,2,1,"div",4)(2,s,2,5,"textarea",18),t.nI1(3,"async"),t.nI1(4,"async"),t.DNE(5,m,1,3,"ds-dynamic-scrollable-dropdown",19),t.nI1(6,"async"),t.DNE(7,p,1,2,"ds-dynamic-onebox",20),t.nI1(8,"async"),t.nI1(9,"async"),t.DNE(10,$,5,7,"button",21),t.nI1(11,"async"),t.nI1(12,"async"),t.DNE(13,W,5,6,"div",22)(14,it,7,9,"div",23),t.nI1(15,"async"),t.nI1(16,"async"),t.DNE(17,st,6,7,"div",24),t.k0s()),2&c){const n=F.ngVar,o=t.XpG().ngVar,r=t.XpG();t.R7$(),t.Y8G("ngIf",!r.mdValue.editing&&!n),t.R7$(),t.Y8G("ngIf",r.mdValue.editing&&!n&&(!0!==t.bMT(3,8,r.isAuthorityControlled())||r.enabledFreeTextEditing&&!0!==t.bMT(4,10,r.isSuggesterVocabulary()))),t.R7$(3),t.Y8G("ngIf",r.mdValue.editing&&t.bMT(6,12,r.isScrollableVocabulary())&&!r.enabledFreeTextEditing),t.R7$(2),t.Y8G("ngIf",r.mdValue.editing&&(t.bMT(8,14,r.isHierarchicalVocabulary())&&!r.enabledFreeTextEditing||t.bMT(9,16,r.isSuggesterVocabulary()))),t.R7$(3),t.Y8G("ngIf",r.mdValue.editing&&(t.bMT(11,18,r.isScrollableVocabulary())||t.bMT(12,20,r.isHierarchicalVocabulary()))),t.R7$(3),t.Y8G("ngIf",!o&&!r.mdValue.editing&&r.mdValue.newValue.authority&&r.mdValue.newValue.confidence!==r.ConfidenceTypeEnum.CF_UNSET&&r.mdValue.newValue.confidence!==r.ConfidenceTypeEnum.CF_NOVALUE),t.R7$(),t.Y8G("ngIf",r.mdValue.editing&&t.bMT(15,22,r.isAuthorityControlled())&&t.bMT(16,24,r.isSuggesterVocabulary())),t.R7$(3),t.Y8G("ngIf",n)}}function ot(c,F){if(1&c&&(t.j41(0,"div",25),t.EFF(1),t.k0s()),2&c){const n=t.XpG(2);t.R7$(),t.JRh(n.mdValue.newValue.language)}}function lt(c,F){if(1&c){const n=t.RV6();t.j41(0,"input",46),t.nI1(1,"translate"),t.mxI("ngModelChange",function(r){t.eBV(n);const j=t.XpG(2);return t.DH7(j.mdValue.newValue.language,r)||(j.mdValue.newValue.language=r),t.Njj(r)}),t.bIt("onDebounce",function(){t.eBV(n);const r=t.XpG(2);return t.Njj(r.confirm.emit(!1))}),t.k0s()}if(2&c){const n=t.XpG(2);t.R50("ngModel",n.mdValue.newValue.language),t.Y8G("dsDebounce",300),t.BMQ("aria-label",t.bMT(1,3,n.dsoType+".edit.metadata.edit.language"))}}function rt(c,F){if(1&c){const n=t.RV6();t.j41(0,"button",47),t.nI1(1,"translate"),t.nI1(2,"translate"),t.nI1(3,"async"),t.bIt("click",function(){t.eBV(n);const r=t.XpG(2);return t.Njj(r.edit.emit())}),t.nrm(4,"i",48),t.k0s()}if(2&c){const n=t.XpG().ngVar,o=t.XpG();t.FS9("ngbTooltip",t.bMT(1,3,o.dsoType+".edit.metadata.edit.buttons.edit")),t.Y8G("title",t.bMT(2,5,o.dsoType+".edit.metadata.edit.buttons.edit"))("dsBtnDisabled",n||o.mdValue.change===o.DsoEditMetadataChangeTypeEnum.REMOVE||t.bMT(3,7,o.saving$))}}function ct(c,F){if(1&c){const n=t.RV6();t.j41(0,"button",49),t.nI1(1,"translate"),t.nI1(2,"translate"),t.nI1(3,"async"),t.bIt("click",function(){t.eBV(n);const r=t.XpG(2);return t.Njj(r.confirm.emit(!0))}),t.nrm(4,"i",50),t.k0s()}if(2&c){const n=t.XpG().ngVar,o=t.XpG();t.FS9("ngbTooltip",t.bMT(1,3,o.dsoType+".edit.metadata.edit.buttons.confirm")),t.Y8G("title",t.bMT(2,5,o.dsoType+".edit.metadata.edit.buttons.confirm"))("dsBtnDisabled",n||t.bMT(3,7,o.saving$))}}function ut(c,F){if(1&c&&(t.j41(0,"button",51),t.nI1(1,"translate"),t.nI1(2,"translate"),t.nrm(3,"i",52),t.k0s()),2&c){const n=F.ngVar,o=t.XpG(2);t.FS9("ngbTooltip",t.bMT(1,5,o.dsoType+".edit.metadata.edit.buttons.drag")),t.Y8G("cdkDragHandleDisabled",n)("ngClass",t.eq3(9,f,n))("dsBtnDisabled",n)("title",t.bMT(2,7,o.dsoType+".edit.metadata.edit.buttons.drag"))}}function _t(c,F){if(1&c){const n=t.RV6();t.j41(0,"div",1),t.bIt("cdkDragStarted",function(){t.eBV(n);const r=t.XpG();return t.Njj(r.dragging.emit(!0))})("cdkDragEnded",function(){t.eBV(n);const r=t.XpG();return t.Njj(r.dragging.emit(!1))}),t.DNE(1,dt,18,26,"div",2),t.nI1(2,"async"),t.j41(3,"div",3),t.DNE(4,ot,2,1,"div",4)(5,lt,2,5,"input",5),t.k0s(),t.j41(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9),t.nI1(10,"translate"),t.DNE(11,rt,5,9,"button",10)(12,ct,5,9,"button",11),t.j41(13,"button",12),t.nI1(14,"translate"),t.nI1(15,"translate"),t.nI1(16,"async"),t.bIt("click",function(){t.eBV(n);const r=t.XpG();return t.Njj(r.remove.emit())}),t.nrm(17,"i",13),t.k0s(),t.j41(18,"button",14),t.nI1(19,"translate"),t.nI1(20,"translate"),t.nI1(21,"async"),t.bIt("click",function(){t.eBV(n);const r=t.XpG();return t.Njj(r.undo.emit())}),t.nrm(22,"i",15),t.k0s(),t.DNE(23,ut,4,11,"button",16),t.nI1(24,"async"),t.k0s()()()()()}if(2&c){const n=F.ngVar,o=t.XpG();t.Y8G("ngClass",t.ziG(32,nt,o.mdValue.reordered||o.mdValue.change===o.DsoEditMetadataChangeTypeEnum.UPDATE,o.mdValue.change===o.DsoEditMetadataChangeTypeEnum.REMOVE,o.mdValue.change===o.DsoEditMetadataChangeTypeEnum.ADD,o.isOnlyValue)),t.R7$(),t.Y8G("ngVar",t.bMT(2,14,o.mdRepresentation$)),t.R7$(3),t.Y8G("ngIf",!o.mdValue.editing),t.R7$(),t.Y8G("ngIf",o.mdValue.editing),t.R7$(4),t.Y8G("ngbTooltip",n?t.bMT(10,16,o.dsoType+".edit.metadata.edit.buttons.virtual"):null),t.R7$(2),t.Y8G("ngIf",!o.mdValue.editing),t.R7$(),t.Y8G("ngIf",o.mdValue.editing),t.R7$(),t.FS9("ngbTooltip",t.bMT(14,18,o.dsoType+".edit.metadata.edit.buttons.remove")),t.Y8G("title",t.bMT(15,20,o.dsoType+".edit.metadata.edit.buttons.remove"))("dsBtnDisabled",n||o.mdValue.change&&o.mdValue.change!==o.DsoEditMetadataChangeTypeEnum.ADD||o.mdValue.editing||t.bMT(16,22,o.saving$)),t.R7$(5),t.FS9("ngbTooltip",t.bMT(19,24,o.dsoType+".edit.metadata.edit.buttons.undo")),t.Y8G("title",t.bMT(20,26,o.dsoType+".edit.metadata.edit.buttons.undo"))("dsBtnDisabled",n||!o.mdValue.change&&o.mdValue.reordered||!o.mdValue.change&&!o.mdValue.editing||t.bMT(21,28,o.saving$)),t.R7$(5),t.Y8G("ngVar",o.isOnlyValue||t.bMT(24,30,o.saving$))}}let mt=(()=>{class c{constructor(n,o,r,j,ht,pt,gt,ft,vt){this.relationshipService=n,this.dsoNameService=o,this.vocabularyService=r,this.itemService=j,this.cdr=ht,this.registryService=pt,this.notificationsService=gt,this.translate=ft,this.metadataService=vt,this.isOnlyValue=!1,this.edit=new t.bkB,this.confirm=new t.bkB,this.remove=new t.bkB,this.undo=new t.bkB,this.dragging=new t.bkB,this.DsoEditMetadataChangeTypeEnum=at.QR,this.ConfidenceTypeEnum=A.l,this.editingAuthority=!1,this.enabledFreeTextEditing=!1,this.group=new g.J3({authorityField:new g.hs}),this.model$=new M.t(null)}ngOnInit(){this.initVirtualProperties(),this.initAuthorityProperties()}initVirtualProperties(){this.mdRepresentation$=this.metadataService.isVirtual(this.mdValue.newValue)?this.relationshipService.resolveMetadataRepresentation(this.mdValue.newValue,this.dso,"Item").pipe((0,_.T)(n=>n.representationType===J.d.Item?n:null)):x.w,this.mdRepresentationItemRoute$=this.mdRepresentation$.pipe((0,_.T)(n=>n?(0,e._o)(n):null)),this.mdRepresentationName$=this.mdRepresentation$.pipe((0,_.T)(n=>n?this.dsoNameService.getName(n):null))}initAuthorityProperties(){if((0,G.hj)(this.mdField)){const n=this.itemService.findByHref(this.dso._links.self.href,!0,!0,(0,K.s)("owningCollection")).pipe((0,U.yd)(),(0,U.Bo)(),(0,d.n)(o=>o.owningCollection),(0,U.yd)(),(0,U.Bo)());this.vocabulary$=n.pipe((0,d.n)(o=>this.vocabularyService.getVocabularyByMetadataAndCollection(this.mdField,o.uuid).pipe((0,U.ak)())))}else this.vocabulary$=(0,P.of)(void 0);this.isAuthorityControlled$=this.vocabulary$.pipe((0,l.M)(n=>this.model$.next(this.createModel(n))),(0,_.T)(n=>(0,G.hj)(n))),this.isHierarchicalVocabulary$=this.vocabulary$.pipe((0,_.T)(n=>(0,G.hj)(n)&&n.hierarchical)),this.isScrollableVocabulary$=this.vocabulary$.pipe((0,_.T)(n=>(0,G.hj)(n)&&n.scrollable)),this.isSuggesterVocabulary$=this.vocabulary$.pipe((0,_.T)(n=>(0,G.hj)(n)&&!n.hierarchical&&!n.scrollable))}createModel(n){if((0,G.hj)(n)){let o;(0,G.hj)(this.mdValue.newValue.value)?(o=new b.e,o.value=this.mdValue.newValue.value,o.display=this.mdValue.newValue.value,this.mdValue.newValue.authority&&(o.authority=this.mdValue.newValue.authority,o.confidence=this.mdValue.newValue.confidence)):o=this.mdValue.newValue.value;const r=n?{closed:!1,name:n.name}:null;return n.scrollable?new X.j({id:"authorityField",label:`${this.dsoType}.edit.metadata.edit.value`,placeholder:`${this.dsoType}.edit.metadata.edit.value`,vocabularyOptions:r,metadataFields:[this.mdField],value:o,repeatable:!1,submissionId:"edit-metadata",hasSelectableMetadata:!1,maxOptions:10}):new q.K({id:"authorityField",label:`${this.dsoType}.edit.metadata.edit.value`,vocabularyOptions:r,metadataFields:[this.mdField],value:o,repeatable:!1,submissionId:"edit-metadata",hasSelectableMetadata:!1})}return null}ngOnChanges(n){(0,G.hj)(n.mdField)&&!n.mdField.firstChange&&(0,G.hj)(n.mdField.currentValue)&&((0,G.hj)(n.mdField.previousValue)&&n.mdField.previousValue!==n.mdField.currentValue&&(this.mdValue.newValue.authority=null,this.mdValue.newValue.confidence=A.l.CF_UNSET),n.mdField.currentValue.includes(".")&&this.validateMetadataField().subscribe(o=>{o&&(this.initAuthorityProperties(),this.cdr.detectChanges())}))}validateMetadataField(){return this.registryService.queryMetadataFields(this.mdField,null,!0,!1,(0,K.s)("schema")).pipe((0,U.qD)(),(0,d.n)(n=>n.hasSucceeded?(0,P.of)(n).pipe((0,U.LB)(),(0,u.s)(1),(0,_.T)(o=>o.indexOf(this.mdField)>-1)):(this.notificationsService.error(this.translate.instant(`${this.dsoType}.edit.metadata.metadatafield.error`),n.errorMessage),[!1])))}isAuthorityControlled(){return this.isAuthorityControlled$}isHierarchicalVocabulary(){return this.isHierarchicalVocabulary$}isScrollableVocabulary(){return this.isScrollableVocabulary$}isSuggesterVocabulary(){return this.isSuggesterVocabulary$}onChangeAuthorityField(n){n?(this.mdValue.newValue.value=n.value,n.authority?(this.mdValue.newValue.authority=n.authority,this.mdValue.newValue.confidence=A.l.CF_ACCEPTED):(this.mdValue.newValue.authority=null,this.mdValue.newValue.confidence=A.l.CF_UNSET),this.confirm.emit(!1)):(this.mdValue.newValue.value="",this.mdValue.newValue.authority=null,this.mdValue.newValue.confidence=A.l.CF_UNSET,this.confirm.emit(!1))}getModel(){return this.model$.value}onChangeEditingAuthorityStatus(n){this.editingAuthority=n}onChangeAuthorityKey(){""===this.mdValue.newValue.authority?(this.mdValue.newValue.confidence=A.l.CF_NOVALUE,this.confirm.emit(!1)):this.mdValue.newValue.authority!==this.mdValue.originalValue.authority&&(this.mdValue.newValue.confidence=A.l.CF_ACCEPTED,this.confirm.emit(!1))}toggleFreeTextEdition(){this.enabledFreeTextEditing&&this.getModel().value!==this.mdValue.newValue.value&&this.initAuthorityProperties(),this.enabledFreeTextEditing=!this.enabledFreeTextEditing}static{this.\u0275fac=function(o){return new(o||c)(t.rXU(L.RelationshipDataService),t.rXU(R.f),t.rXU(O.g),t.rXU(h.ItemDataService),t.rXU(t.gRc),t.rXU(v.x),t.rXU(V.I),t.rXU(E.c$),t.rXU(Q.T))}}static{this.\u0275cmp=t.VBU({type:c,selectors:[["ds-dso-edit-metadata-value"]],inputs:{dso:"dso",mdValue:"mdValue",dsoType:"dsoType",saving$:"saving$",isOnlyValue:"isOnlyValue",mdField:"mdField"},outputs:{edit:"edit",confirm:"confirm",remove:"remove",undo:"undo",dragging:"dragging"},standalone:!0,features:[t.OA$,t.aNF],decls:1,vars:1,consts:[["class","d-flex flex-row ds-value-row","role","row","cdkDrag","",3,"ngClass","cdkDragStarted","cdkDragEnded",4,"ngVar"],["role","row","cdkDrag","",1,"d-flex","flex-row","ds-value-row",3,"cdkDragStarted","cdkDragEnded","ngClass"],["class","flex-grow-1 ds-flex-cell ds-value-cell d-flex flex-column","role","cell",4,"ngVar"],["role","cell",1,"ds-flex-cell","ds-lang-cell"],["class","dont-break-out preserve-line-breaks",4,"ngIf"],["class","form-control","type","text",3,"ngModel","dsDebounce","ngModelChange","onDebounce",4,"ngIf"],["role","cell",1,"text-center","ds-flex-cell","ds-edit-cell"],[1,"btn-group"],[1,"edit-field"],[1,"btn-group","edit-buttons",3,"ngbTooltip"],["class","btn btn-outline-primary btn-sm ng-star-inserted","data-test","metadata-edit-btn",3,"title","ngbTooltip","dsBtnDisabled","click",4,"ngIf"],["class","btn btn-outline-success btn-sm ng-star-inserted","data-test","metadata-confirm-btn",3,"title","ngbTooltip","dsBtnDisabled","click",4,"ngIf"],["data-test","metadata-remove-btn",1,"btn","btn-outline-danger","btn-sm",3,"click","title","ngbTooltip","dsBtnDisabled"],[1,"fas","fa-trash-alt","fa-fw"],["data-test","metadata-undo-btn",1,"btn","btn-outline-warning","btn-sm",3,"click","title","ngbTooltip","dsBtnDisabled"],[1,"fas","fa-undo-alt","fa-fw"],["class","btn btn-outline-secondary ds-drag-handle btn-sm","data-test","metadata-drag-btn","cdkDragHandle","",3,"cdkDragHandleDisabled","ngClass","dsBtnDisabled","title","ngbTooltip",4,"ngVar"],["role","cell",1,"flex-grow-1","ds-flex-cell","ds-value-cell","d-flex","flex-column"],["class","form-control","rows","5",3,"ngModel","dsDebounce","ngModelChange","onDebounce",4,"ngIf"],[3,"bindId","group","model","change",4,"ngIf"],[3,"group","model","change",4,"ngIf"],["class","btn btn-secondary mt-2",3,"title","click",4,"ngIf"],[4,"ngIf"],["class","mt-2",4,"ngIf"],["class","d-flex",4,"ngIf"],[1,"dont-break-out","preserve-line-breaks"],["rows","5",1,"form-control",3,"ngModelChange","onDebounce","ngModel","dsDebounce"],[3,"change","bindId","group","model"],[3,"change","group","model"],[1,"btn","btn-secondary","mt-2",3,"click","title"],[1,"fas","fa-fw",3,"ngClass"],[1,"badge","badge-light","border"],["dsAuthorityConfidenceState","","aria-hidden","true",1,"fas","fa-fw","p-0",3,"authorityValue","iconMode"],[1,"mt-2"],[1,"btn-group","w-75"],["dsAuthorityConfidenceState","","aria-hidden","true",1,"fas","fa-fw","p-0","mr-1","mt-auto","mb-auto",3,"authorityValue","iconMode"],["data-test","authority-input",1,"form-control","form-outline",3,"ngModelChange","change","ngModel","disabled"],["class","btn btn-outline-secondary btn-sm ng-star-inserted","id","metadata-confirm-btn",3,"title","ngbTooltip","click",4,"ngIf"],["class","btn btn-outline-success btn-sm ng-star-inserted","id","metadata-confirm-btn",3,"title","ngbTooltip","click",4,"ngIf"],["id","metadata-confirm-btn",1,"btn","btn-outline-secondary","btn-sm","ng-star-inserted",3,"click","title","ngbTooltip"],[1,"fas","fa-lock","fa-fw"],["id","metadata-confirm-btn",1,"btn","btn-outline-success","btn-sm","ng-star-inserted",3,"click","title","ngbTooltip"],[1,"fas","fa-lock-open","fa-fw"],[1,"d-flex"],["target","_blank",1,"mr-2",3,"routerLink"],[3,"object"],["type","text",1,"form-control",3,"ngModelChange","onDebounce","ngModel","dsDebounce"],["data-test","metadata-edit-btn",1,"btn","btn-outline-primary","btn-sm","ng-star-inserted",3,"click","title","ngbTooltip","dsBtnDisabled"],[1,"fas","fa-edit","fa-fw"],["data-test","metadata-confirm-btn",1,"btn","btn-outline-success","btn-sm","ng-star-inserted",3,"click","title","ngbTooltip","dsBtnDisabled"],[1,"fas","fa-check","fa-fw"],["data-test","metadata-drag-btn","cdkDragHandle","",1,"btn","btn-outline-secondary","ds-drag-handle","btn-sm",3,"cdkDragHandleDisabled","ngClass","dsBtnDisabled","title","ngbTooltip"],[1,"fas","fa-grip-vertical","fa-fw"]],template:function(o,r){1&o&&t.DNE(0,_t,25,37,"div",0),2&o&&t.Y8G("ngVar",r.metadataService.isVirtual(r.mdValue.newValue))},dependencies:[tt.r,T.T1,a.YU,a.bT,g.YN,g.me,g.BC,g.vS,B.R,S.Wk,C.C,y.n8,y.md,T.Fb,a.Jj,E.h,E.D9,I.s,Z.d,D.K,z.A],styles:[".ds-success[_ngcontent-%COMP%]{background-color:var(--ds-success-bg);border:1px solid var(--bs-success)}.ds-drag-handle[_ngcontent-%COMP%]:not(.disabled){cursor:grab}  .edit-field>ngb-tooltip-window .tooltip-inner{min-width:var(--ds-dso-edit-virtual-tooltip-min-width)}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}",".ds-field-row[_ngcontent-%COMP%]{border:1px solid var(--bs-gray-400)}.ds-flex-cell[_ngcontent-%COMP%]{padding:1rem;border:1px solid var(--bs-gray-200)}.ds-lang-cell[_ngcontent-%COMP%]{min-width:var(--ds-dso-edit-lang-width);max-width:var(--ds-dso-edit-lang-width)}.ds-edit-cell[_ngcontent-%COMP%]{min-width:var(--ds-dso-edit-actions-width)}.ds-value-row[_ngcontent-%COMP%]{background-color:#fff}.ds-value-row[_ngcontent-%COMP%]:active{cursor:grabbing}.ds-value-row.ds-warning[_ngcontent-%COMP%]{background-color:var(--ds-warning-bg)}.ds-value-row.ds-warning[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-warning)}.ds-value-row.ds-danger[_ngcontent-%COMP%]{background-color:var(--ds-danger-bg)}.ds-value-row.ds-danger[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-danger)}.ds-value-row.ds-success[_ngcontent-%COMP%]{background-color:var(--ds-success-bg)}.ds-value-row.ds-success[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-success)}"]})}}return c})()},33278:(k,w,i)=>{"use strict";i.r(w),i.d(w,{DsoEditMetadataComponent:()=>nt});var T=i(60177),a=i(41780),t=i(84412),g=i(84572),S=i(7673),y=i(96354),E=i(88141),M=i(73028),x=i(82640),P=i(4047),d=(i(76829),i(80183)),l=i(42547),u=i(16292),v=i(47978),O=i(60456),V=i(82777),R=i(82394),h=i(39806),L=i(24591),Q=i(27656),A=i(40659),et=i(80987),J=i(28043),U=i(57227),e=i(54438),z=i(7901),G=i(52717);let Z=(()=>{class f{diff(s,m){return this.getMoves(s,m).map(p=>Object.assign({op:"move",from:"/"+p[0],path:"/"+p[1]}))}getMoves(s,m){const p=[...m];return s.reduce(($,W,Y)=>{if((0,V.a4)(W)&&W!==p[Y]){const H=p.lastIndexOf(W);(0,G.HD)(p,H,Y),$.unshift([Y,H])}return $},[])}static{this.\u0275fac=function(m){return new(m||f)}}static{this.\u0275prov=e.jDH({token:f,factory:f.\u0275fac,providedIn:"root"})}}return f})();function q(f,N){if(1&f){const s=e.RV6();e.j41(0,"button",20),e.nI1(1,"async"),e.nI1(2,"translate"),e.nI1(3,"translate"),e.bIt("click",function(){e.eBV(s);const p=e.XpG(2);return e.Njj(p.reinstate())}),e.nrm(4,"i",21),e.j41(5,"span",6),e.EFF(6),e.nI1(7,"translate"),e.k0s()()}if(2&f){const s=e.XpG(2);e.Y8G("dsBtnDisabled",e.bMT(1,4,s.saving$))("title",e.bMT(2,6,s.dsoType+".edit.metadata.reinstate-button")),e.BMQ("aria-label",e.bMT(3,8,s.dsoType+".edit.metadata.reinstate-button")),e.R7$(6),e.SpI("\xa0",e.bMT(7,10,s.dsoType+".edit.metadata.reinstate-button"),"")}}function I(f,N){if(1&f){const s=e.RV6();e.j41(0,"button",22),e.nI1(1,"translate"),e.nI1(2,"async"),e.nI1(3,"translate"),e.bIt("click",function(){e.eBV(s);const p=e.XpG(2);return e.Njj(p.discard())}),e.nrm(4,"i",23),e.j41(5,"span",6),e.EFF(6),e.nI1(7,"translate"),e.k0s()()}if(2&f){const s=e.XpG(2);e.Y8G("title",e.bMT(1,4,s.dsoType+".edit.metadata.discard-button"))("dsBtnDisabled",!s.hasChanges||e.bMT(2,6,s.saving$)),e.BMQ("aria-label",e.bMT(3,8,s.dsoType+".edit.metadata.discard-button")),e.R7$(6),e.SpI("\xa0",e.bMT(7,10,s.dsoType+".edit.metadata.discard-button"),"")}}function X(f,N){if(1&f){const s=e.RV6();e.j41(0,"div",24)(1,"div",25)(2,"ds-metadata-field-selector",26),e.mxI("mdFieldChange",function(p){e.eBV(s);const $=e.XpG(2);return e.DH7($.newMdField,p)||($.newMdField=p),e.Njj(p)}),e.k0s()(),e.j41(3,"div",27)(4,"div",11),e.nrm(5,"ds-dso-edit-metadata-value-headers",28),e.j41(6,"ds-dso-edit-metadata-value",29),e.bIt("confirm",function(p){e.eBV(s);const $=e.XpG(2);return e.Njj($.confirmNewValue(p))})("remove",function(){e.eBV(s);const p=e.XpG(2);return e.Njj(p.form.newValue=void 0)})("undo",function(){e.eBV(s);const p=e.XpG(2);return e.Njj(p.form.newValue=void 0)}),e.k0s()()()()}if(2&f){const s=e.XpG(2);e.R7$(2),e.Y8G("dsoType",s.dsoType),e.R50("mdField",s.newMdField),e.Y8G("autofocus",!0),e.R7$(3),e.Y8G("dsoType",s.dsoType),e.R7$(),e.Y8G("dso",s.dso)("mdValue",s.form.newValue)("dsoType",s.dsoType)("saving$",s.savingOrLoadingFieldValidation$)("isOnlyValue",!0)("mdField",s.newMdField)}}function b(f,N){if(1&f){const s=e.RV6();e.j41(0,"div",34),e.bIt("click",function(){e.eBV(s);const p=e.XpG().$implicit,$=e.XpG(2);return $.form.resetOrder(p),e.Njj($.onValueSaved())}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}if(2&f){const s=e.XpG(3);e.R7$(),e.SpI(" ",e.bMT(2,1,s.dsoType+".edit.metadata.reset-order-button")," ")}}function D(f,N){if(1&f){const s=e.RV6();e.j41(0,"div",24)(1,"div",30)(2,"span",31),e.EFF(3),e.k0s(),e.DNE(4,b,3,3,"div",32),e.k0s(),e.j41(5,"ds-dso-edit-metadata-field-values",33),e.bIt("valueSaved",function(){e.eBV(s);const p=e.XpG(2);return e.Njj(p.onValueSaved())}),e.k0s()()}if(2&f){const s=N.$implicit,m=e.XpG(2);e.R7$(3),e.JRh(s),e.R7$(),e.Y8G("ngIf",m.form.hasOrderChanges(s)),e.R7$(),e.Y8G("dso",m.dso)("form",m.form)("dsoType",m.dsoType)("saving$",m.saving$)("draggingMdField$",m.draggingMdField$)("mdField",s)}}function C(f,N){if(1&f&&(e.j41(0,"div"),e.nrm(1,"ds-alert",35),e.k0s()),2&f){const s=e.XpG(2);e.R7$(),e.Y8G("content",s.dsoType+".edit.metadata.empty")("type",s.AlertTypeEnum.Info)}}function B(f,N){if(1&f){const s=e.RV6();e.j41(0,"button",36),e.nI1(1,"async"),e.nI1(2,"translate"),e.nI1(3,"translate"),e.bIt("click",function(){e.eBV(s);const p=e.XpG(2);return e.Njj(p.reinstate())}),e.nrm(4,"i",21),e.EFF(5),e.nI1(6,"translate"),e.k0s()}if(2&f){const s=e.XpG(2);e.Y8G("dsBtnDisabled",e.bMT(1,4,s.saving$))("title",e.bMT(2,6,s.dsoType+".edit.metadata.reinstate-button")),e.BMQ("aria-label",e.bMT(3,8,s.dsoType+".edit.metadata.reinstate-button")),e.R7$(5),e.SpI(" ",e.bMT(6,10,s.dsoType+".edit.metadata.reinstate-button")," ")}}function K(f,N){if(1&f){const s=e.RV6();e.j41(0,"button",37),e.nI1(1,"translate"),e.nI1(2,"async"),e.nI1(3,"translate"),e.bIt("click",function(){e.eBV(s);const p=e.XpG(2);return e.Njj(p.discard())}),e.nrm(4,"i",23),e.EFF(5),e.nI1(6,"translate"),e.k0s()}if(2&f){const s=e.XpG(2);e.Y8G("title",e.bMT(1,4,s.dsoType+".edit.metadata.discard-button"))("dsBtnDisabled",!s.hasChanges||e.bMT(2,6,s.saving$)),e.BMQ("aria-label",e.bMT(3,8,s.dsoType+".edit.metadata.discard-button")),e.R7$(5),e.SpI(" ",e.bMT(6,10,s.dsoType+".edit.metadata.discard-button")," ")}}function tt(f,N){if(1&f){const s=e.RV6();e.j41(0,"div",2)(1,"div",3)(2,"button",4),e.nI1(3,"async"),e.nI1(4,"translate"),e.nI1(5,"translate"),e.bIt("click",function(){e.eBV(s);const p=e.XpG();return e.Njj(p.add())}),e.nrm(6,"i",5),e.j41(7,"span",6),e.EFF(8),e.nI1(9,"translate"),e.k0s()(),e.DNE(10,q,8,12,"button",7),e.j41(11,"button",8),e.nI1(12,"async"),e.nI1(13,"translate"),e.nI1(14,"translate"),e.bIt("click",function(){e.eBV(s);const p=e.XpG();return e.Njj(p.submit())}),e.nrm(15,"i",9),e.j41(16,"span",6),e.EFF(17),e.nI1(18,"translate"),e.k0s()(),e.DNE(19,I,8,12,"button",10),e.k0s(),e.j41(20,"div",11),e.nI1(21,"translate"),e.nrm(22,"ds-dso-edit-metadata-headers",12),e.DNE(23,X,7,10,"div",13)(24,D,6,8,"div",14),e.k0s(),e.DNE(25,C,2,2,"div",1),e.j41(26,"div",15)(27,"div",16),e.DNE(28,B,7,12,"button",17),e.j41(29,"button",18),e.nI1(30,"async"),e.nI1(31,"translate"),e.nI1(32,"translate"),e.bIt("click",function(){e.eBV(s);const p=e.XpG();return e.Njj(p.submit())}),e.nrm(33,"i",9),e.EFF(34),e.nI1(35,"translate"),e.k0s(),e.DNE(36,K,7,12,"button",19),e.k0s()()()}if(2&f){const s=e.XpG();e.R7$(2),e.Y8G("dsBtnDisabled",s.form.newValue||e.bMT(3,21,s.saving$))("title",e.bMT(4,23,s.dsoType+".edit.metadata.add-button")),e.BMQ("aria-label",e.bMT(5,25,s.dsoType+".edit.metadata.add-button")),e.R7$(6),e.SpI("\xa0",e.bMT(9,27,s.dsoType+".edit.metadata.add-button"),""),e.R7$(2),e.Y8G("ngIf",s.isReinstatable),e.R7$(),e.Y8G("dsBtnDisabled",!s.hasChanges||e.bMT(12,29,s.saving$))("title",e.bMT(13,31,s.dsoType+".edit.metadata.save-button")),e.BMQ("aria-label",e.bMT(14,33,s.dsoType+".edit.metadata.save-button")),e.R7$(6),e.SpI("\xa0",e.bMT(18,35,s.dsoType+".edit.metadata.save-button"),""),e.R7$(2),e.Y8G("ngIf",!s.isReinstatable),e.R7$(),e.BMQ("aria-label",e.bMT(21,37,"item.edit.head")),e.R7$(2),e.Y8G("dsoType",s.dsoType),e.R7$(),e.Y8G("ngIf",s.form.newValue),e.R7$(),e.Y8G("ngForOf",s.form.fieldKeys),e.R7$(),e.Y8G("ngIf",s.isEmpty&&!s.form.newValue),e.R7$(3),e.Y8G("ngIf",s.isReinstatable),e.R7$(),e.Y8G("dsBtnDisabled",!s.hasChanges||e.bMT(30,39,s.saving$))("title",e.bMT(31,41,s.dsoType+".edit.metadata.save-button")),e.BMQ("aria-label",e.bMT(32,43,s.dsoType+".edit.metadata.save-button")),e.R7$(5),e.SpI(" ",e.bMT(35,45,s.dsoType+".edit.metadata.save-button")," "),e.R7$(2),e.Y8G("ngIf",!s.isReinstatable)}}function at(f,N){1&f&&e.nrm(0,"ds-loading")}let nt=(()=>{class f{constructor(s,m,p,$,W,Y,H){this.route=s,this.notificationsService=m,this.translateService=p,this.parentInjector=$,this.arrayMoveChangeAnalyser=W,this.cdr=Y,this.dataServiceMap=H,this.saving$=new t.t(!1),this.draggingMdField$=new t.t(null),this.loadingFieldValidation$=new t.t(!1),this.AlertTypeEnum=v.v}ngOnInit(){(0,V.Tn)(this.dso)?this.dsoUpdateSubscription=(0,g.z)([this.route.data,this.route.parent.data]).pipe((0,y.T)(([s,m])=>Object.assign({},s,m)),(0,E.M)(s=>this.initDSO(s.dso.payload)),(0,M.Z)(()=>this.retrieveDataService())).subscribe(s=>{this.initDataService(s),this.initForm()}):(this.initDSOType(this.dso),this.retrieveDataService().subscribe(s=>{this.initDataService(s),this.initForm()})),this.savingOrLoadingFieldValidation$=(0,g.z)([this.saving$,this.loadingFieldValidation$]).pipe((0,y.T)(([s,m])=>s||m))}retrieveDataService(){return(0,V.Tn)(this.updateDataService)?(0,P.M)(this.dataServiceMap,this.dsoType,this.parentInjector):(0,S.of)(this.updateDataService)}initDSO(s){this.dso=s,this.initDSOType(s)}initDSOType(s){let m;m="string"==typeof s.type?new l.v(s.type):s.type,this.dsoType=m.value}initDataService(s){(0,V.hj)(s)&&(this.updateDataService=s)}initForm(){this.form=new Q.qf(this.dso.metadata),this.onValueSaved(),this.cdr.detectChanges()}onValueSaved(){this.hasChanges=this.form.hasChanges(),this.isReinstatable=this.form.isReinstatable(),this.isEmpty=0===Object.keys(this.form.fields).length}submit(){this.saving$.next(!0),this.updateDataService.patch(this.dso,this.form.getOperations(this.arrayMoveChangeAnalyser)).pipe((0,d.qD)()).subscribe(s=>{this.saving$.next(!1),s.hasFailed?this.notificationsService.error(this.translateService.instant(`${this.dsoType}.edit.metadata.notifications.error.title`),s.errorMessage):(this.notificationsService.success(this.translateService.instant(`${this.dsoType}.edit.metadata.notifications.saved.title`),this.translateService.instant(`${this.dsoType}.edit.metadata.notifications.saved.content`)),this.dso=s.payload,this.initForm())})}confirmNewValue(s){s&&this.setMetadataField()}setMetadataField(){this.form.resetReinstatable(),this.loadingFieldValidation$.next(!0),this.metadataFieldSelectorComponent.validate().subscribe(s=>{this.loadingFieldValidation$.next(!1),s&&(this.form.setMetadataField(this.newMdField),this.onValueSaved())})}add(){this.newMdField=void 0,this.form.add()}discard(){this.form.discard(),this.onValueSaved()}reinstate(){this.form.reinstate(),this.onValueSaved()}ngOnDestroy(){(0,V.a4)(this.dsoUpdateSubscription)&&this.dsoUpdateSubscription.unsubscribe()}static{this.\u0275fac=function(m){return new(m||f)(e.rXU(z.nX),e.rXU(h.I),e.rXU(a.c$),e.rXU(e.zZn),e.rXU(Z),e.rXU(e.gRc),e.rXU(x.l9))}}static{this.\u0275cmp=e.VBU({type:f,selectors:[["ds-base-dso-edit-metadata"]],viewQuery:function(m,p){if(1&m&&e.GBs(U.g,5),2&m){let $;e.mGM($=e.lsd())&&(p.metadataFieldSelectorComponent=$.first)}},inputs:{dso:"dso",updateDataService:"updateDataService"},standalone:!0,features:[e.aNF],decls:2,vars:2,consts:[["class","item-metadata",4,"ngIf"],[4,"ngIf"],[1,"item-metadata"],[1,"button-row","top","d-flex","my-2","space-children-mr","ml-gap"],["id","dso-add-btn",1,"mr-auto","btn","btn-success",3,"click","dsBtnDisabled","title"],["aria-hidden","true",1,"fas","fa-plus"],[1,"d-none","d-sm-inline"],["class","btn btn-warning ml-1","id","dso-reinstate-btn",3,"dsBtnDisabled","title","click",4,"ngIf"],["id","dso-save-btn",1,"btn","btn-primary","ml-1",3,"click","dsBtnDisabled","title"],["aria-hidden","true",1,"fas","fa-save"],["class","btn btn-danger ml-1","id","dso-discard-btn",3,"title","dsBtnDisabled","click",4,"ngIf"],["role","table"],[3,"dsoType"],["class","d-flex flex-row ds-field-row","role","row",4,"ngIf"],["class","d-flex flex-row ds-field-row","role","row",4,"ngFor","ngForOf"],[1,"button-row","bottom","d-inline-block","w-100"],[1,"mt-2","float-right","space-children-mr","ml-gap"],["class","btn btn-warning",3,"dsBtnDisabled","title","click",4,"ngIf"],[1,"btn","btn-primary",3,"click","dsBtnDisabled","title"],["class","btn btn-danger",3,"title","dsBtnDisabled","click",4,"ngIf"],["id","dso-reinstate-btn",1,"btn","btn-warning","ml-1",3,"click","dsBtnDisabled","title"],["aria-hidden","true",1,"fas","fa-undo-alt"],["id","dso-discard-btn",1,"btn","btn-danger","ml-1",3,"click","title","dsBtnDisabled"],["aria-hidden","true",1,"fas","fa-times"],["role","row",1,"d-flex","flex-row","ds-field-row"],["role","rowheader",1,"lbl-cell","ds-success"],[3,"mdFieldChange","dsoType","mdField","autofocus"],["role","cell",1,"flex-grow-1","ds-drop-list"],["role","presentation",3,"dsoType"],[3,"confirm","remove","undo","dso","mdValue","dsoType","saving$","isOnlyValue","mdField"],["role","rowheader",1,"lbl-cell"],[1,"dont-break-out","preserve-line-breaks"],["class","btn btn-warning reset-order-button mt-2 w-100",3,"click",4,"ngIf"],["role","cell",1,"flex-grow-1",3,"valueSaved","dso","form","dsoType","saving$","draggingMdField$","mdField"],[1,"btn","btn-warning","reset-order-button","mt-2","w-100",3,"click"],[3,"content","type"],[1,"btn","btn-warning",3,"click","dsBtnDisabled","title"],[1,"btn","btn-danger",3,"click","title","dsBtnDisabled"]],template:function(m,p){1&m&&e.DNE(0,tt,37,47,"div",0)(1,at,1,0,"ds-loading",1),2&m&&(e.Y8G("ngIf",p.form),e.R7$(),e.Y8G("ngIf",!p.form))},dependencies:[T.bT,A.L,U.g,J.c,et.o,T.pM,L.t,u.C,R.v,T.Jj,a.h,a.D9,O.A],styles:[".lbl-cell[_ngcontent-%COMP%]{min-width:var(--ds-dso-edit-field-width);max-width:var(--ds-dso-edit-field-width);background-color:var(--bs-gray-100);font-weight:700;padding:1rem;border:1px solid var(--bs-gray-200)}.lbl-cell.ds-success[_ngcontent-%COMP%]{background-color:var(--ds-success-bg);border:1px solid var(--bs-success)}.ds-field-row[_ngcontent-%COMP%]{border:1px solid var(--bs-gray-400)}.reset-order-button[_ngcontent-%COMP%]:hover{cursor:pointer}"]})}}return f})()},57227:(k,w,i)=>{"use strict";i.d(w,{g:()=>q});var T=i(60177),a=i(54438),t=i(89417),g=i(41780),S=i(86820),y=i(84412),E=i(84572),M=i(7673),x=i(70152),P=i(99172),_=i(25558),d=i(96697),l=i(96354),u=i(88141),v=i(6238),O=i(67558),V=i(80183),R=i(82777),h=i(82394),L=i(39806),Q=i(46301),A=i(67600);const et=["mdFieldInput"],J=I=>({"is-invalid":I}),U=I=>({show:I});function e(I,X){if(1&I&&(a.j41(0,"div",10),a.EFF(1),a.nI1(2,"translate"),a.k0s()),2&I){const b=a.XpG();a.R7$(),a.JRh(a.bMT(2,1,b.dsoType+".edit.metadata.metadatafield.invalid"))}}function z(I,X){if(1&I){const b=a.RV6();a.j41(0,"button",12,1),a.bIt("click",function(){const C=a.eBV(b).$implicit,B=a.XpG(2);return a.Njj(B.select(C))}),a.nrm(2,"span",13),a.k0s()}if(2&I){const b=X.$implicit;a.R7$(2),a.Y8G("innerHTML",b,a.npT)}}function G(I,X){if(1&I&&(a.qex(0),a.DNE(1,z,3,1,"button",11),a.nI1(2,"async"),a.bVm()),2&I){const b=a.XpG();a.R7$(),a.Y8G("ngForOf",a.bMT(2,1,b.mdFieldOptions$))}}function Z(I,X){1&I&&(a.j41(0,"button",14),a.nrm(1,"ds-loading",15),a.k0s()),2&I&&(a.R7$(),a.Y8G("showMessage",!1))}let q=(()=>{class I{constructor(b,D,C){this.registryService=b,this.notificationsService=D,this.translate=C,this.autofocus=!1,this.mdFieldChange=new a.bkB,this.mdFieldOptions$=new y.t([]),this.input=new t.hs,this.query$=new y.t(null),this.debounceTime=300,this.selectedValueLoading=!1,this.showInvalid=!1,this.subs=[],this.currentPage$=new y.t(1),this.hasNextPage=!1,this.loading=!1,this.pageOptions={elementsPerPage:20,sort:new v.z("fieldName",v.U.ASC)}}ngOnInit(){this.subs.push(this.input.valueChanges.pipe((0,x.B)(this.debounceTime),(0,P.Z)("")).subscribe(b=>{this.currentPage$.next(1),this.selectedValueLoading||this.query$.next(b),this.mdField=b,this.mdFieldChange.emit(this.mdField)})),this.subs.push((0,E.z)(this.query$,this.currentPage$).pipe((0,_.n)(([b,D])=>(this.loading=!0,1===D&&this.mdFieldOptions$.next([]),this.search(b,D)))).subscribe(b=>{this.selectedValueLoading||this.updateList(b)}))}ngAfterViewInit(){this.autofocus&&this.mdFieldInput.nativeElement.focus()}validate(){return this.registryService.queryMetadataFields(this.mdField,null,!0,!1,(0,A.s)("schema")).pipe((0,V.qD)(),(0,_.n)(b=>b.hasSucceeded?(0,M.of)(b).pipe((0,V.LB)(),(0,d.s)(1),(0,l.T)(D=>D.indexOf(this.mdField)>-1),(0,u.M)(D=>this.showInvalid=!D)):(this.notificationsService.error(this.translate.instant(`${this.dsoType}.edit.metadata.metadatafield.error`),b.errorMessage),[!1])))}select(b){this.selectedValueLoading=!0,this.input.setValue(b)}onScrollDown(){this.hasNextPage&&!this.loading&&this.currentPage$.next(this.currentPage$.value+1)}updateList(b){this.loading=!1,this.hasNextPage=b.length>0;const D=this.mdFieldOptions$.getValue();this.mdFieldOptions$.next([...D,...b]),this.selectedValueLoading=!1}search(b,D,C=!0){return this.registryService.queryMetadataFields(b,{elementsPerPage:this.pageOptions.elementsPerPage,sort:this.pageOptions.sort,currentPage:D},C,!1,(0,A.s)("schema")).pipe((0,V.v7)(),(0,V.LB)())}ngOnDestroy(){this.subs.filter(b=>(0,R.a4)(b)).forEach(b=>b.unsubscribe())}static{this.\u0275fac=function(D){return new(D||I)(a.rXU(O.x),a.rXU(L.I),a.rXU(g.c$))}}static{this.\u0275cmp=a.VBU({type:I,selectors:[["ds-metadata-field-selector"]],viewQuery:function(D,C){if(1&D&&a.GBs(et,7),2&D){let B;a.mGM(B=a.lsd())&&(C.mdFieldInput=B.first)}},inputs:{dsoType:"dsoType",mdField:"mdField",autofocus:"autofocus"},outputs:{mdFieldChange:"mdFieldChange"},standalone:!0,features:[a.aNF],decls:12,vars:22,consts:[["mdFieldInput",""],["listEntryElement",""],[1,"w-100","position-relative"],["type","text",1,"form-control",3,"focusin","dsClickOutside","click","keyup","ngClass","value","formControl"],["class","invalid-feedback show-feedback",4,"ngIf"],["id","scrollable-metadata-field-selector",1,"dropdown-menu","scrollable-menu",3,"ngClass"],[1,"dropdown-list"],["infiniteScroll","",3,"scrolled","infiniteScrollDistance","infiniteScrollThrottle","infiniteScrollContainer","fromRoot"],[4,"ngIf"],["class","list-group-item list-group-item-action border-0 list-entry",4,"ngIf"],[1,"invalid-feedback","show-feedback"],["class","d-block dropdown-item","dsHoverClass","ds-hover",3,"click",4,"ngFor","ngForOf"],["dsHoverClass","ds-hover",1,"d-block","dropdown-item",3,"click"],[3,"innerHTML"],[1,"list-group-item","list-group-item-action","border-0","list-entry"],[3,"showMessage"]],template:function(D,C){if(1&D){const B=a.RV6();a.j41(0,"div",2)(1,"input",3,0),a.nI1(3,"translate"),a.bIt("focusin",function(){return a.eBV(B),a.Njj(C.query$.next(C.mdField))})("dsClickOutside",function(){return a.eBV(B),a.Njj(C.query$.next(null))})("click",function(tt){return a.eBV(B),a.Njj(tt.stopPropagation())})("keyup",function(){return a.eBV(B),a.Njj(C.selectedValueLoading=!1)}),a.k0s(),a.DNE(4,e,3,3,"div",4),a.j41(5,"div",5),a.nI1(6,"async"),a.j41(7,"div",6)(8,"div",7),a.bIt("scrolled",function(){return a.eBV(B),a.Njj(C.onScrollDown())}),a.DNE(9,G,3,3,"ng-container",8),a.nI1(10,"async"),a.DNE(11,Z,2,1,"button",9),a.k0s()()()()}if(2&D){let B;a.R7$(),a.Y8G("ngClass",a.eq3(18,J,C.showInvalid))("value",C.mdField)("formControl",C.input),a.BMQ("aria-label",a.bMT(3,12,C.dsoType+".edit.metadata.metadatafield")),a.R7$(3),a.Y8G("ngIf",C.showInvalid),a.R7$(),a.Y8G("ngClass",a.eq3(20,U,(null==(B=a.bMT(6,14,C.mdFieldOptions$))?null:B.length)>0)),a.R7$(3),a.Y8G("infiniteScrollDistance",1)("infiniteScrollThrottle",0)("infiniteScrollContainer","#scrollable-metadata-field-selector")("fromRoot",!0),a.R7$(),a.Y8G("ngIf",a.bMT(10,16,C.mdFieldOptions$)),a.R7$(2),a.Y8G("ngIf",C.loading)}},dependencies:[t.YN,t.me,t.BC,T.YU,t.X1,t.l_,Q.z,T.bT,T.pM,T.Jj,g.h,g.D9,h.v,S.eO,S.DP],styles:[".scrollable-menu[_ngcontent-%COMP%]{height:auto;max-height:var(--ds-dso-selector-list-max-height);overflow:scroll}"]})}}return I})()},13707:(k,w,i)=>{"use strict";i.d(w,{Q:()=>E}),i(76829);var a=i(8886),g=(i(33278),i(54438));const S=["*"];function y(M,x){}let E=(()=>{class M extends a.J{constructor(){super(...arguments),this.inAndOutputNames=["dso","updateDataService"]}getComponentName(){return"DsoEditMetadataComponent"}importThemedComponent(P){return i(30207)(`./${P}/app/dso-shared/dso-edit-metadata/dso-edit-metadata.component`)}importUnthemedComponent(){return Promise.resolve().then(i.bind(i,33278))}static{this.\u0275fac=(()=>{let P;return function(d){return(P||(P=g.xGo(M)))(d||M)}})()}static{this.\u0275cmp=g.VBU({type:M,selectors:[["ds-dso-edit-metadata"]],inputs:{dso:"dso",updateDataService:"updateDataService"},standalone:!0,features:[g.Vt3,g.aNF],ngContentSelectors:S,decls:5,vars:0,consts:[["vcr",""],["content",""]],template:function(_,d){1&_&&(g.NAR(),g.DNE(0,y,0,0,"ng-template",null,0,g.C5r),g.j41(2,"div",null,1),g.SdG(4),g.k0s())},encapsulation:2})}}return M})()},30207:(k,w,i)=>{var T={"./custom/app/dso-shared/dso-edit-metadata/dso-edit-metadata.component":[46296,6296]};function a(t){if(!i.o(T,t))return Promise.resolve().then(()=>{var y=new Error("Cannot find module '"+t+"'");throw y.code="MODULE_NOT_FOUND",y});var g=T[t],S=g[0];return i.e(g[1]).then(()=>i(S))}a.keys=()=>Object.keys(T),a.id=30207,k.exports=a}}]);