"use strict";(self.webpackChunkdspace_angular=self.webpackChunkdspace_angular||[]).push([[6549],{66549:(O,_,r)=>{r.r(_),r.d(_,{ROUTES:()=>me});var g=r(70379),v=r(26479),o=r(60177),f=r(7901),d=r(41780),y=r(84412),$=r(44437),S=r(96354),P=r(5964),h=r(25558),u=r(96697),R=r(22978),b=r(67558),F=r(80183),I=r(39806),T=r(5682),U=r(41023);function j(n,c){return Object.assign(new U._,c,{currentPage:n.currentPage,elementsPerPage:n.pageSize})}var E=r(23401),e=r(54438),p=r(1473),G=r(32872),C=r(33126),x=r(13143);function V(n,c){1&n&&e.nrm(0,"div")}function X(n,c){if(1&n&&(e.j41(0,"h2"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.JRh(e.bMT(2,1,t.messagePrefix+".create"))}}function D(n,c){if(1&n&&(e.j41(0,"h2"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.JRh(e.bMT(2,1,t.messagePrefix+".edit"))}}let B=(()=>{class n{constructor(t,a,i){this.registryService=t,this.formBuilderService=a,this.translateService=i,this.formId="metadata-schema-form",this.messagePrefix="admin.registries.metadata.form",this.formLayout={name:{grid:{host:"col col-sm-6 d-inline-block"}},namespace:{grid:{host:"col col-sm-6 d-inline-block"}}},this.submitForm=new e.bkB,this.subscriptions=[]}ngOnInit(){this.name=new p.rA_({id:"name",label:this.translateService.instant(`${this.messagePrefix}.name`),name:"name",validators:{required:null,pattern:"^[^. ,]*$",maxLength:32},required:!0,errorMessages:{pattern:"error.validation.metadata.name.invalid-pattern",maxLength:"error.validation.metadata.name.max-length"}}),this.namespace=new p.rA_({id:"namespace",label:this.translateService.instant(`${this.messagePrefix}.namespace`),name:"namespace",validators:{required:null,maxLength:256},required:!0,errorMessages:{maxLength:"error.validation.metadata.namespace.max-length"}}),this.formModel=[new p.iO5({id:"metadatadataschemagroup",group:[this.namespace,this.name]})],this.formGroup=this.formBuilderService.createFormGroup(this.formModel),this.activeMetadataSchema$=this.registryService.getActiveMetadataSchema(),this.subscriptions.push(this.activeMetadataSchema$.subscribe(t=>{null==t?this.clearFields():(this.formGroup.patchValue({metadatadataschemagroup:{name:t.prefix,namespace:t.namespace}}),this.name.disabled=!0)}))}onCancel(){this.registryService.cancelEditMetadataSchema()}onSubmit(){this.activeMetadataSchema$.pipe((0,u.s)(1),(0,h.n)(t=>{const a={prefix:this.name.value,namespace:this.namespace.value};return this.registryService.createOrUpdateMetadataSchema(null==t?Object.assign(new G.p,a):Object.assign(new G.p,t,{namespace:a.namespace}))}),(0,h.n)(t=>this.registryService.clearMetadataSchemaRequests().pipe((0,S.T)(()=>t)))).subscribe(t=>{this.submitForm.emit(t),this.clearFields(),this.registryService.cancelEditMetadataSchema()})}clearFields(){this.formGroup.reset("metadatadataschemagroup"),this.name.disabled=!1}ngOnDestroy(){this.onCancel(),this.subscriptions.forEach(t=>t.unsubscribe())}static{this.\u0275fac=function(a){return new(a||n)(e.rXU(b.x),e.rXU(C.j),e.rXU(d.c$))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["ds-metadata-schema-form"]],outputs:{submitForm:"submitForm"},standalone:!0,features:[e.aNF],decls:7,vars:9,consts:[["createHeader",""],["editheader",""],[4,"ngIf","ngIfThen","ngIfElse"],[3,"cancel","submitForm","formId","formModel","formGroup","formLayout"]],template:function(a,i){if(1&a){const s=e.RV6();e.DNE(0,V,1,0,"div",2),e.nI1(1,"async"),e.DNE(2,X,3,3,"ng-template",null,0,e.C5r)(4,D,3,3,"ng-template",null,1,e.C5r),e.j41(6,"ds-form",3),e.bIt("cancel",function(){return e.eBV(s),e.Njj(i.onCancel())})("submitForm",function(){return e.eBV(s),e.Njj(i.onSubmit())}),e.k0s()}if(2&a){const s=e.sdS(3),l=e.sdS(5);e.Y8G("ngIf",e.bMT(1,7,i.activeMetadataSchema$))("ngIfThen",l)("ngIfElse",s),e.R7$(6),e.Y8G("formId",i.formId)("formModel",i.formModel)("formGroup",i.formGroup)("formLayout",i.formLayout)}},dependencies:[o.bT,o.Jj,d.h,d.D9,x.s],encapsulation:2})}}return n})();const J=n=>({"table-primary":n}),M=n=>[n];function L(n,c){if(1&n){const t=e.RV6();e.j41(0,"tr",15),e.nI1(1,"async"),e.j41(2,"td")(3,"label",16)(4,"input",17),e.nI1(5,"async"),e.bIt("change",function(i){const s=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.selectMetadataSchema(s,i))}),e.k0s(),e.j41(6,"span",13),e.EFF(7),e.nI1(8,"async"),e.nI1(9,"translate"),e.k0s()()(),e.j41(10,"td",18),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.editSchema(i))}),e.j41(11,"a",19),e.EFF(12),e.k0s()(),e.j41(13,"td",18),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.editSchema(i))}),e.j41(14,"a",19),e.EFF(15),e.k0s()(),e.j41(16,"td",18),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.editSchema(i))}),e.j41(17,"a",19),e.EFF(18),e.k0s()()()}if(2&n){let t,a,i;const s=c.$implicit,l=e.XpG(2);e.Y8G("ngClass",e.eq3(17,J,(null==(t=e.bMT(1,9,l.activeMetadataSchema$))?null:t.id)===s.id)),e.R7$(4),e.Y8G("checked",null==(a=e.bMT(5,11,l.selectedMetadataSchemaIDs$))?null:a.includes(s.id)),e.R7$(3),e.JRh(e.bMT(9,15,null!=(i=e.bMT(8,13,l.selectedMetadataSchemaIDs$))&&i.includes(s.id)?"admin.registries.metadata.schemas.deselect":"admin.registries.metadata.schemas.select")),e.R7$(4),e.Y8G("routerLink",e.eq3(19,M,s.prefix)),e.R7$(),e.JRh(s.id),e.R7$(2),e.Y8G("routerLink",e.eq3(21,M,s.prefix)),e.R7$(),e.JRh(s.namespace),e.R7$(2),e.Y8G("routerLink",e.eq3(23,M,s.prefix)),e.R7$(),e.JRh(s.prefix)}}function Y(n,c){if(1&n&&(e.j41(0,"ds-pagination",9),e.nI1(1,"async"),e.j41(2,"div",10)(3,"table",11)(4,"thead")(5,"tr")(6,"th",12)(7,"span",13),e.EFF(8),e.nI1(9,"translate"),e.k0s()(),e.j41(10,"th",12),e.EFF(11),e.nI1(12,"translate"),e.k0s(),e.j41(13,"th",12),e.EFF(14),e.nI1(15,"translate"),e.k0s(),e.j41(16,"th",12),e.EFF(17),e.nI1(18,"translate"),e.k0s()()(),e.j41(19,"tbody"),e.DNE(20,L,19,25,"tr",14),e.nI1(21,"async"),e.k0s()()()()),2&n){let t,a;const i=e.XpG();e.Y8G("paginationOptions",i.config)("collectionSize",null==(t=e.bMT(1,9,i.metadataSchemas))||null==t.payload?null:t.payload.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),e.R7$(8),e.JRh(e.bMT(9,11,"admin.registries.metadata.schemas.table.selected")),e.R7$(3),e.JRh(e.bMT(12,13,"admin.registries.metadata.schemas.table.id")),e.R7$(3),e.JRh(e.bMT(15,15,"admin.registries.metadata.schemas.table.namespace")),e.R7$(3),e.JRh(e.bMT(18,17,"admin.registries.metadata.schemas.table.name")),e.R7$(3),e.Y8G("ngForOf",null==(a=e.bMT(21,19,i.metadataSchemas))||null==a.payload?null:a.payload.page)}}function A(n,c){1&n&&(e.j41(0,"div",20),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&n&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"admin.registries.metadata.schemas.no-items")," "))}function w(n,c){if(1&n){const t=e.RV6();e.j41(0,"button",21),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.deleteSchemas())}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&n&&(e.R7$(),e.JRh(e.bMT(2,1,"admin.registries.metadata.schemas.table.delete")))}let z=(()=>{class n{constructor(t,a,i,s){this.registryService=t,this.notificationsService=a,this.paginationService=i,this.translateService=s,this.config=Object.assign(new E.W,{id:"rm",pageSize:25}),this.needsUpdate$=new y.t(!0),this.subscriptions=[]}ngOnInit(){this.activeMetadataSchema$=this.registryService.getActiveMetadataSchema(),this.selectedMetadataSchemaIDs$=this.registryService.getSelectedMetadataSchemas().pipe((0,S.T)(t=>t.map(a=>a.id))),this.updateSchemas()}updateSchemas(){this.metadataSchemas=this.needsUpdate$.pipe((0,P.p)(t=>!0===t),(0,h.n)(()=>this.paginationService.getCurrentPagination(this.config.id,this.config)),(0,h.n)(t=>this.registryService.getMetadataSchemas(j(t))))}forceUpdateSchemas(){this.needsUpdate$.next(!0)}editSchema(t){this.subscriptions.push(this.activeMetadataSchema$.pipe((0,u.s)(1)).subscribe(a=>{t===a?this.registryService.cancelEditMetadataSchema():this.registryService.editMetadataSchema(t)}))}selectMetadataSchema(t,a){a.target.checked?this.registryService.selectMetadataSchema(t):this.registryService.deselectMetadataSchema(t)}deleteSchemas(){this.subscriptions.push(this.selectedMetadataSchemaIDs$.pipe((0,u.s)(1),(0,h.n)(t=>(0,$.y)(t.map(a=>this.registryService.deleteMetadataSchema(a).pipe((0,F.qD)()))))).subscribe(t=>{const a=t.filter(s=>s.hasSucceeded),i=t.filter(s=>s.hasFailed);a.length>0&&this.showNotification(!0,a.length),i.length>0&&this.showNotification(!1,i.length),this.registryService.deselectAllMetadataSchema(),this.registryService.cancelEditMetadataSchema()}))}showNotification(t,a){const i="admin.registries.schema.notification",s=t?"success":"failure",l=this.translateService.instant(`${i}.${s}`),m=this.translateService.instant(`${i}.deleted.${s}`,{amount:a});t?this.notificationsService.success(l,m):this.notificationsService.error(l,m)}ngOnDestroy(){this.paginationService.clearPagination(this.config.id),this.subscriptions.map(t=>t.unsubscribe())}static{this.\u0275fac=function(a){return new(a||n)(e.rXU(b.x),e.rXU(I.I),e.rXU(R.m),e.rXU(d.c$))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["ds-metadata-registry"]],standalone:!0,features:[e.aNF],decls:17,vars:15,consts:[[1,"container"],[1,"metadata-registry","row"],[1,"col-12"],["id","header",1,"border-bottom","pb-2"],["id","description",1,"pb-2"],[3,"submitForm"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage",4,"ngIf"],["class","alert alert-info w-100 mb-2","role","alert",4,"ngIf"],["type","submit","class","btn btn-danger float-right",3,"click",4,"ngIf"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"table-responsive"],["id","metadata-schemas",1,"table","table-striped","table-hover"],["scope","col"],[1,"sr-only"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[1,"mb-0"],["type","checkbox",3,"change","checked"],[1,"selectable-row",3,"click"],[3,"routerLink"],["role","alert",1,"alert","alert-info","w-100","mb-2"],["type","submit",1,"btn","btn-danger","float-right",3,"click"]],template:function(a,i){if(1&a&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),e.EFF(4),e.nI1(5,"translate"),e.k0s(),e.j41(6,"p",4),e.EFF(7),e.nI1(8,"translate"),e.k0s(),e.j41(9,"ds-metadata-schema-form",5),e.bIt("submitForm",function(){return i.forceUpdateSchemas()}),e.k0s(),e.DNE(10,Y,22,21,"ds-pagination",6),e.nI1(11,"async"),e.DNE(12,A,3,3,"div",7),e.nI1(13,"async"),e.j41(14,"div"),e.DNE(15,w,3,3,"button",8),e.nI1(16,"async"),e.k0s()()()()),2&a){let s,l,m;e.R7$(4),e.JRh(e.bMT(5,5,"admin.registries.metadata.head")),e.R7$(3),e.JRh(e.bMT(8,7,"admin.registries.metadata.description")),e.R7$(3),e.Y8G("ngIf",(null==(s=e.bMT(11,9,i.metadataSchemas))||null==s.payload?null:s.payload.totalElements)>0),e.R7$(2),e.Y8G("ngIf",0===(null==(l=e.bMT(13,11,i.metadataSchemas))||null==l.payload?null:l.payload.totalElements)),e.R7$(3),e.Y8G("ngIf",(null==(m=e.bMT(16,13,i.metadataSchemas))||null==m.payload||null==m.payload.page?null:m.payload.page.length)>0)}},dependencies:[B,d.h,d.D9,o.Jj,T.e,o.bT,o.Sq,o.YU,f.Wk],styles:[".selectable-row[_ngcontent-%COMP%]:hover{cursor:pointer}[_nghost-%COMP%]     #metadatadataschemagroup{display:flex}"]})}}return n})();var k=r(84572),W=r(7673),q=r(18226),N=r(52733);function H(n,c){1&n&&e.nrm(0,"div")}function K(n,c){if(1&n&&(e.j41(0,"h2"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.JRh(e.bMT(2,1,t.messagePrefix+".create"))}}function Q(n,c){if(1&n&&(e.j41(0,"h2"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.JRh(e.bMT(2,1,t.messagePrefix+".edit"))}}let Z=(()=>{class n{constructor(t,a,i){this.registryService=t,this.formBuilderService=a,this.translateService=i,this.formId="metadata-field-form",this.messagePrefix="admin.registries.schema.form",this.formLayout={element:{grid:{host:"col col-sm-6 d-inline-block"}},qualifier:{grid:{host:"col col-sm-6 d-inline-block"}},scopeNote:{grid:{host:"col col-sm-12 d-inline-block"}}},this.submitForm=new e.bkB}ngOnInit(){(0,k.z)([this.translateService.get(`${this.messagePrefix}.element`),this.translateService.get(`${this.messagePrefix}.qualifier`),this.translateService.get(`${this.messagePrefix}.scopenote`)]).subscribe(([t,a,i])=>{this.element=new p.rA_({id:"element",label:t,name:"element",validators:{required:null,pattern:"^[^. ,]*$",maxLength:64},required:!0,errorMessages:{pattern:"error.validation.metadata.element.invalid-pattern",maxLength:"error.validation.metadata.element.max-length"}}),this.qualifier=new p.rA_({id:"qualifier",label:a,name:"qualifier",validators:{pattern:"^[^. ,]*$",maxLength:64},required:!1,errorMessages:{pattern:"error.validation.metadata.qualifier.invalid-pattern",maxLength:"error.validation.metadata.qualifier.max-length"}}),this.scopeNote=new p.Zex({id:"scopeNote",label:i,name:"scopeNote",required:!1,rows:5}),this.formModel=[new p.iO5({id:"metadatadatafieldgroup",group:[this.element,this.qualifier,this.scopeNote]})],this.formGroup=this.formBuilderService.createFormGroup(this.formModel),this.registryService.getActiveMetadataField().subscribe(s=>{null==s?this.clearFields():(this.formGroup.patchValue({metadatadatafieldgroup:{element:s.element,qualifier:s.qualifier,scopeNote:s.scopeNote}}),this.element.disabled=!0,this.qualifier.disabled=!0)})})}onCancel(){this.registryService.cancelEditMetadataField()}onSubmit(){this.registryService.getActiveMetadataField().pipe((0,u.s)(1)).subscribe(t=>{null==t?this.registryService.createMetadataField(Object.assign(new N.A,{element:this.element.value,qualifier:this.qualifier.value,scopeNote:this.scopeNote.value}),this.metadataSchema).subscribe(a=>{this.submitForm.emit(a)}):this.registryService.updateMetadataField(Object.assign(new N.A,t,{id:t.id,element:t.element,qualifier:t.qualifier,scopeNote:this.scopeNote.value})).subscribe(a=>{this.submitForm.emit(a)}),this.clearFields(),this.registryService.cancelEditMetadataField()})}clearFields(){this.formGroup.reset("metadatadatafieldgroup"),this.element.disabled=!1,this.qualifier.disabled=!1}ngOnDestroy(){this.onCancel()}static{this.\u0275fac=function(a){return new(a||n)(e.rXU(b.x),e.rXU(C.j),e.rXU(d.c$))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["ds-metadata-field-form"]],inputs:{metadataSchema:"metadataSchema"},outputs:{submitForm:"submitForm"},standalone:!0,features:[e.aNF],decls:7,vars:9,consts:[["createHeader",""],["editheader",""],[4,"ngIf","ngIfThen","ngIfElse"],[3,"cancel","submit","formId","formModel","formLayout","formGroup"]],template:function(a,i){if(1&a){const s=e.RV6();e.DNE(0,H,1,0,"div",2),e.nI1(1,"async"),e.DNE(2,K,3,3,"ng-template",null,0,e.C5r)(4,Q,3,3,"ng-template",null,1,e.C5r),e.j41(6,"ds-form",3),e.bIt("cancel",function(){return e.eBV(s),e.Njj(i.onCancel())})("submit",function(){return e.eBV(s),e.Njj(i.onSubmit())}),e.k0s()}if(2&a){const s=e.sdS(3),l=e.sdS(5);e.Y8G("ngIf",e.bMT(1,7,i.registryService.getActiveMetadataField()))("ngIfThen",l)("ngIfElse",s),e.R7$(6),e.Y8G("formId",i.formId)("formModel",i.formModel)("formLayout",i.formLayout)("formGroup",i.formGroup)}},dependencies:[o.bT,x.s,d.h,d.D9,o.Jj],encapsulation:2})}}return n})();const ee=n=>({namespace:n}),te=()=>["/admin/registries/metadata"],ae=n=>({"table-primary":n});function ie(n,c){if(1&n){const t=e.RV6();e.j41(0,"td")(1,"input",20),e.nI1(2,"translate"),e.bIt("change",function(i){e.eBV(t);const s=e.XpG().$implicit,l=e.XpG(4);return e.Njj(l.selectMetadataField(s,i))}),e.k0s()()}if(2&n){const t=c.ngVar;e.R7$(),e.Y8G("checked",t),e.BMQ("aria-label",e.bMT(2,2,t?"admin.registries.schema.fields.deselect":"admin.registries.schema.fields.select"))}}function ne(n,c){if(1&n){const t=e.RV6();e.j41(0,"tr",18),e.nI1(1,"async"),e.DNE(2,ie,3,4,"td",7),e.nI1(3,"async"),e.j41(4,"td",19),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG(4);return e.Njj(s.editField(i))}),e.EFF(5),e.k0s(),e.j41(6,"td",19),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG(4);return e.Njj(s.editField(i))}),e.EFF(7),e.k0s(),e.j41(8,"td",19),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG(4);return e.Njj(s.editField(i))}),e.EFF(9),e.k0s()()}if(2&n){let t,a;const i=c.$implicit,s=e.XpG(3).ngVar,l=e.XpG();e.Y8G("ngClass",e.eq3(11,ae,(null==(t=e.bMT(1,7,l.activeField$))?null:t.id)===i.id)),e.R7$(2),e.Y8G("ngVar",null==(a=e.bMT(3,9,l.selectedMetadataFieldIDs$))?null:a.includes(i.id)),e.R7$(3),e.JRh(i.id),e.R7$(2),e.E5c("",null==s?null:s.prefix,".",i.element,"",i.qualifier?"."+i.qualifier:"",""),e.R7$(2),e.JRh(i.scopeNote)}}function se(n,c){if(1&n&&(e.j41(0,"ds-pagination",12)(1,"div",13)(2,"table",14)(3,"thead")(4,"tr")(5,"th")(6,"span",15),e.EFF(7),e.nI1(8,"translate"),e.k0s()(),e.j41(9,"th",16),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"th",16),e.EFF(13),e.nI1(14,"translate"),e.k0s(),e.j41(15,"th",16),e.EFF(16),e.nI1(17,"translate"),e.k0s()()(),e.j41(18,"tbody"),e.DNE(19,ne,10,13,"tr",17),e.k0s()()()()),2&n){const t=e.XpG().ngVar,a=e.XpG(2);e.Y8G("paginationOptions",a.config)("collectionSize",null==t?null:t.totalElements)("hideGear",!1)("hidePagerWhenSinglePage",!0),e.R7$(7),e.JRh(e.bMT(8,9,"admin.registries.schema.fields.table.selected")),e.R7$(3),e.JRh(e.bMT(11,11,"admin.registries.schema.fields.table.id")),e.R7$(3),e.JRh(e.bMT(14,13,"admin.registries.schema.fields.table.field")),e.R7$(3),e.JRh(e.bMT(17,15,"admin.registries.schema.fields.table.scopenote")),e.R7$(3),e.Y8G("ngForOf",null==t?null:t.page)}}function re(n,c){1&n&&(e.j41(0,"div",21),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&n&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"admin.registries.schema.fields.no-items")," "))}function le(n,c){if(1&n){const t=e.RV6();e.j41(0,"button",22),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.deleteFields())}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&n&&(e.R7$(),e.JRh(e.bMT(2,1,"admin.registries.schema.fields.table.delete")))}function ce(n,c){if(1&n&&(e.qex(0),e.DNE(1,se,20,17,"ds-pagination",8)(2,re,3,3,"div",9),e.j41(3,"div")(4,"button",10),e.EFF(5),e.nI1(6,"translate"),e.k0s(),e.DNE(7,le,3,3,"button",11),e.k0s(),e.bVm()),2&n){const t=c.ngVar;e.R7$(),e.Y8G("ngIf",(null==t?null:t.totalElements)>0),e.R7$(),e.Y8G("ngIf",0===(null==t?null:t.totalElements)),e.R7$(2),e.Y8G("routerLink",e.lJ4(7,te)),e.R7$(),e.JRh(e.bMT(6,5,"admin.registries.schema.return")),e.R7$(2),e.Y8G("ngIf",(null==t||null==t.page?null:t.page.length)>0)}}function oe(n,c){if(1&n){const t=e.RV6();e.j41(0,"div",3)(1,"h1",4),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"p",5),e.EFF(5),e.nI1(6,"translate"),e.k0s(),e.j41(7,"ds-metadata-field-form",6),e.bIt("submitForm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.forceUpdateFields())}),e.k0s(),e.j41(8,"h2"),e.EFF(9),e.nI1(10,"translate"),e.k0s(),e.DNE(11,ce,8,8,"ng-container",7),e.nI1(12,"async"),e.k0s()}if(2&n){let t;const a=c.ngVar,i=e.XpG();e.R7$(2),e.Lme("",e.bMT(3,6,"admin.registries.schema.head"),': "',null==a?null:a.prefix,'"'),e.R7$(3),e.JRh(e.i5U(6,8,"admin.registries.schema.description",e.eq3(15,ee,null==a?null:a.namespace))),e.R7$(2),e.Y8G("metadataSchema",a),e.R7$(2),e.JRh(e.bMT(10,11,"admin.registries.schema.fields.head")),e.R7$(2),e.Y8G("ngVar",null==(t=e.bMT(12,13,i.metadataFields$))?null:t.payload)}}const me=[{path:"metadata",resolve:{breadcrumb:g.S},data:{title:"admin.registries.metadata.title",breadcrumbKey:"admin.registries.metadata"},children:[{path:"",component:z},{path:":schemaName",resolve:{breadcrumb:g.S},component:(()=>{class n{constructor(t,a,i,s,l){this.registryService=t,this.route=a,this.notificationsService=i,this.paginationService=s,this.translateService=l,this.config=Object.assign(new E.W,{id:"rm",pageSize:25,pageSizeOptions:[25,50,100,200]}),this.needsUpdate$=new y.t(!0),this.subscriptions=[]}ngOnInit(){this.metadataSchema$=this.registryService.getMetadataSchemaByPrefix(this.route.snapshot.params.schemaName).pipe((0,F.ak)()),this.activeField$=this.registryService.getActiveMetadataField(),this.selectedMetadataFieldIDs$=this.registryService.getSelectedMetadataFields().pipe((0,S.T)(t=>t.map(a=>a.id))),this.updateFields()}updateFields(){this.metadataFields$=this.paginationService.getCurrentPagination(this.config.id,this.config).pipe((0,h.n)(t=>(0,k.z)([this.metadataSchema$,this.needsUpdate$,(0,W.of)(t)])),(0,h.n)(([t,a,i])=>(a&&this.needsUpdate$.next(!1),this.registryService.getMetadataFieldsBySchema(t,j(i),!a,!0))))}forceUpdateFields(){this.registryService.clearMetadataFieldRequests(),this.needsUpdate$.next(!0)}editField(t){this.subscriptions.push(this.activeField$.pipe((0,u.s)(1)).subscribe(a=>{t===a?this.registryService.cancelEditMetadataField():this.registryService.editMetadataField(t)}))}selectMetadataField(t,a){a.target.checked?this.registryService.selectMetadataField(t):this.registryService.deselectMetadataField(t)}deleteFields(){this.subscriptions.push(this.selectedMetadataFieldIDs$.pipe((0,u.s)(1),(0,h.n)(t=>(0,$.y)(t.map(a=>this.registryService.deleteMetadataField(a).pipe((0,F.qD)()))))).subscribe(t=>{const a=t.filter(s=>s.hasSucceeded),i=t.filter(s=>s.hasFailed);a.length>0&&this.showNotification(!0,a.length),i.length>0&&this.showNotification(!1,i.length),this.registryService.deselectAllMetadataField(),this.registryService.cancelEditMetadataField()}))}showNotification(t,a){const i="admin.registries.schema.notification",s=t?"success":"failure",l=this.translateService.instant(`${i}.${s}`),m=this.translateService.instant(`${i}.field.deleted.${s}`,{amount:a});t?this.notificationsService.success(l,m):this.notificationsService.error(l,m)}ngOnDestroy(){this.paginationService.clearPagination(this.config.id),this.registryService.deselectAllMetadataField(),this.subscriptions.forEach(t=>t.unsubscribe())}static{this.\u0275fac=function(a){return new(a||n)(e.rXU(b.x),e.rXU(f.nX),e.rXU(I.I),e.rXU(R.m),e.rXU(d.c$))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["ds-metadata-schema"]],standalone:!0,features:[e.aNF],decls:4,vars:3,consts:[[1,"container"],[1,"metadata-schema","row"],["class","col-12",4,"ngVar"],[1,"col-12"],["id","header",1,"border-bottom","pb-2"],["id","description",1,"pb-2"],[3,"submitForm","metadataSchema"],[4,"ngVar"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage",4,"ngIf"],["class","alert alert-info w-100 mb-2","role","alert",4,"ngIf"],[1,"btn","btn-primary",3,"routerLink"],["type","submit","class","btn btn-danger float-right",3,"click",4,"ngIf"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"table-responsive"],["id","metadata-fields",1,"table","table-striped","table-hover"],[1,"sr-only"],["scope","col"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[1,"selectable-row",3,"click"],["type","checkbox",3,"change","checked"],["role","alert",1,"alert","alert-info","w-100","mb-2"],["type","submit",1,"btn","btn-danger","float-right",3,"click"]],template:function(a,i){1&a&&(e.j41(0,"div",0)(1,"div",1),e.DNE(2,oe,13,17,"div",2),e.nI1(3,"async"),e.k0s()()),2&a&&(e.R7$(2),e.Y8G("ngVar",e.bMT(3,1,i.metadataSchema$)))},dependencies:[o.Jj,q.r,Z,d.h,d.D9,T.e,o.bT,o.Sq,o.YU,f.Wk],styles:[".selectable-row[_ngcontent-%COMP%]:hover{cursor:pointer}[_nghost-%COMP%]     #metadatadatafieldgroup{display:flex;flex-wrap:wrap}"]})}}return n})(),data:{title:"admin.registries.schema.title",breadcrumbKey:"admin.registries.schema"}}]},{path:v.B,resolve:{breadcrumb:g.S},loadChildren:()=>r.e(4416).then(r.bind(r,64416)).then(n=>n.ROUTES),data:{title:"admin.registries.bitstream-formats.title",breadcrumbKey:"admin.registries.bitstream-formats"}}]},26479:(O,_,r)=>{r.d(_,{B:()=>o,J:()=>f});var g=r(45663),v=r(47483);const o="bitstream-formats";function f(){return new g.t((0,v.P$)(),o).toString()}}}]);