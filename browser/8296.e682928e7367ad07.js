"use strict";(self.webpackChunkdspace_angular=self.webpackChunkdspace_angular||[]).push([[8296],{70025:(T,f,t)=>{t.d(f,{G:()=>o,o:()=>p});var r=t(96354),d=t(69799),h=t(82777),l=t(80183);const o=(D,u,n,S,...O)=>p(D,u,D.params.id,n,S,...O),p=(D,u,n,S,O,...M)=>O.findById(n,!0,!1,...M).pipe((0,l.qD)(),(0,l.Bo)(),(0,r.T)(I=>{if((0,h.a4)(I))return{provider:S,key:I,url:(0,d.wN)(I)}}))},6056:(T,f,t)=>{t.d(f,{L:()=>h});var r=t(96354),d=t(17024);const h=(l,o)=>(0,d.FO)(l,(p,D)=>o(p,D).pipe((0,r.T)(u=>[u])))},17024:(T,f,t)=>{t.d(f,{FO:()=>D});var r=t(96354),d=t(82777),h=t(80183),l=t(51581);const p=u=>(n,S)=>{const O=(u=>{let n=u;for(;(0,d.Tn)(n.params.id)&&(0,d.a4)(n.parent);)n=n.parent;return n})(n);return u(O,S).pipe((0,h.Hz)(),(0,r.T)(M=>M.self))},D=(u,n,S=p,O)=>(0,l.h)((M,I)=>n(M,I),S(u()),O)},81225:(T,f,t)=>{t.d(f,{j:()=>h});const d={RESOLVED:(0,t(91e3).N)("dspace/resolver/RESOLVED")};class h{constructor(o,p){this.type=d.RESOLVED,this.payload={url:o,dso:p}}}},85021:(T,f,t)=>{t.d(f,{c:()=>Y});var r=t(54438),d=t(7673),h=t(84572),l=t(25558),o=t(96354),p=t(69799),D=t(13989),u=t(65007),n=t(3970),S=t(98926),O=t(6041),M=t(10046),I=t(88318),g=t(80183),A=t(75447),P=t(45663),E=t(82777),W=t(39548),B=t(19340),C=t(34237),z=t(39806),N=t(10781),x=t(88141),U=t(29326),j=t(81783),H=t(93860),F=t(24261),b=t(76604),G=t(13574),L=t(52149),$=t(7901);let Q=(()=>{class v{constructor(e,i,s,c,a,m,y){this.modalService=e,this.versionService=i,this.versionHistoryService=s,this.itemVersionShared=c,this.router=a,this.workspaceItemDataService=m,this.itemService=y}openCreateVersionModal(e){const i=e,s=i._links.version.href,c=this.modalService.open(G.L);this.versionService.findByHref(s).pipe((0,g.qD)()).subscribe(a=>{c.componentInstance.firstVersion=a.hasNoContent,c.componentInstance.versionNumber=a.hasNoContent?void 0:a.payload.version}),c.componentInstance.createVersionEvent.pipe((0,l.n)(a=>this.versionHistoryService.createVersion(i._links.self.href,a)),(0,g.qD)(),(0,x.M)(()=>c.close()),(0,x.M)(a=>{this.itemVersionShared.notifyCreateNewVersion(a)}),(0,g.ak)(),(0,l.n)(a=>this.itemService.findByHref(a._links.item.href)),(0,g.ak)(),(0,l.n)(a=>this.workspaceItemDataService.findByItem(a.uuid,!0,!1)),(0,g.ak)()).subscribe(a=>{this.router.navigateByUrl("workspaceitems/"+a.id+"/edit")})}isNewVersionButtonDisabled(e){return this.versionHistoryService.hasDraftVersion$(e._links.version.href).pipe((0,o.T)(i=>!!i))}getVersioningTooltipMessage(e,i,s){return this.isNewVersionButtonDisabled(e).pipe((0,l.n)(c=>(0,d.of)(c?i:s)))}static{this.\u0275fac=function(i){return new(i||v)(r.KVO(L.Bq),r.KVO(j.VersionDataService),r.KVO(H.VersionHistoryDataService),r.KVO(b.h),r.KVO($.Ix),r.KVO(F.WorkspaceitemDataService),r.KVO(U.ItemDataService))}}static{this.\u0275prov=r.jDH({token:v,factory:v.\u0275fac,providedIn:"root"})}}return v})();var R=t(71306),X=t(41780);let J=(()=>{class v{constructor(e,i,s,c,a,m,y,K,V,w){this.dSpaceObjectDataService=e,this.menuService=i,this.authorizationService=s,this.modalService=c,this.dsoVersioningModalService=a,this.researcherProfileService=m,this.notificationsService=y,this.translate=K,this.dsoWithdrawnReinstateModalService=V,this.correctionTypeDataService=w}resolve(e,i){let s=e.params.id;return(0,E.Tn)(s)&&(0,E.a4)(e.queryParams.scope)&&(s=e.queryParams.scope),(0,E.Tn)(s)?(0,d.of)({...e.data?.menu}):this.dSpaceObjectDataService.findById(s,!0,!1).pipe((0,g.qD)(),(0,l.n)(c=>{if(c.hasSucceeded){const a=c.payload;return(0,h.z)(this.getDsoMenus(a,e,i)).pipe((0,o.T)(m=>[].concat.apply([],m)),(0,o.T)(m=>this.addDsoUuidToMenuIDs(m,a)),(0,o.T)(m=>({...e.data?.menu,[B.D.DSO_EDIT]:m})))}return(0,d.of)({...e.data?.menu})}))}getDsoMenus(e,i,s){return[this.getItemMenu(e),this.getComColMenu(e),this.getCommonMenu(e,s)]}getCommonMenu(e,i){return(0,h.z)([this.authorizationService.isAuthorized(n._.CanEditMetadata,e.self)]).pipe((0,o.T)(([s])=>[{id:"edit-dso",active:!1,visible:s,model:{type:C.x.LINK,text:this.getDsoType(e)+".page.edit",link:new P.t((0,p.wN)(e),"edit","metadata").toString()},icon:"pencil-alt",index:2}]))}getItemMenu(e){return e instanceof I.q?(0,h.z)([this.authorizationService.isAuthorized(n._.CanCreateVersion,e.self),this.dsoVersioningModalService.isNewVersionButtonDisabled(e),this.dsoVersioningModalService.getVersioningTooltipMessage(e,"item.page.version.hasDraft","item.page.version.create"),this.authorizationService.isAuthorized(n._.CanSynchronizeWithORCID,e.self),this.authorizationService.isAuthorized(n._.CanClaimItem,e.self),this.correctionTypeDataService.findByItem(e.uuid,!0).pipe((0,g.qD)(),(0,g.Bo)())]).pipe((0,o.T)(([i,s,c,a,m,y])=>{const K="person"===this.getDsoType(e);return[{id:"orcid-dso",active:!1,visible:K&&a,model:{type:C.x.LINK,text:"item.page.orcid.tooltip",link:new P.t((0,p.wN)(e),"orcid").toString()},icon:"orcid fab fa-lg",index:0},{id:"version-dso",active:!1,visible:i,model:{type:C.x.ONCLICK,text:c,disabled:s,function:()=>{this.dsoVersioningModalService.openCreateVersionModal(e)}},icon:"code-branch",index:1},{id:"claim-dso",active:!1,visible:K&&m,model:{type:C.x.ONCLICK,text:"item.page.claim.button",function:()=>{this.claimResearcher(e)}},icon:"hand-paper",index:3},{id:"withdrawn-item",active:!1,visible:e.isArchived&&y?.page.some(V=>V.topic===R.pc),model:{type:C.x.ONCLICK,text:"item.page.withdrawn",function:()=>{this.dsoWithdrawnReinstateModalService.openCreateWithdrawnReinstateModal(e,"request-withdrawn",e.isArchived)}},icon:"eye-slash",index:4},{id:"reinstate-item",active:!1,visible:e.isWithdrawn&&y?.page.some(V=>V.topic===R.el),model:{type:C.x.ONCLICK,text:"item.page.reinstate",function:()=>{this.dsoWithdrawnReinstateModalService.openCreateWithdrawnReinstateModal(e,"request-reinstate",e.isArchived)}},icon:"eye",index:5}]})):(0,d.of)([])}getComColMenu(e){return e instanceof M.E||e instanceof O.p?(0,h.z)([this.authorizationService.isAuthorized(n._.CanSubscribe,e.self)]).pipe((0,o.T)(([i])=>[{id:"subscribe",active:!1,visible:i,model:{type:C.x.ONCLICK,text:"subscriptions.tooltip",function:()=>{this.modalService.open(N.w).componentInstance.dso=e}},icon:"bell",index:4}])):(0,d.of)([])}claimResearcher(e){this.researcherProfileService.createFromExternalSourceAndReturnRelatedItemId(e.self).subscribe(i=>{(0,E.hj)(i)?(this.notificationsService.success(this.translate.get("researcherprofile.success.claim.title"),this.translate.get("researcherprofile.success.claim.body")),this.authorizationService.invalidateAuthorizationsRequestCache(),this.menuService.hideMenuSection(B.D.DSO_EDIT,"claim-dso-"+e.uuid)):this.notificationsService.error(this.translate.get("researcherprofile.error.claim.title"),this.translate.get("researcherprofile.error.claim.body"))})}getDsoType(e){const i=e.getRenderTypes()[0];return"string"==typeof i||i instanceof String?i.toLowerCase():e.type.toString().toLowerCase()}addDsoUuidToMenuIDs(e,i){return e.map(s=>(Object.assign(s,{id:s.id+"-"+i.uuid}),(0,E.a4)(s.parentID)&&Object.assign(s,{parentID:s.parentID+"-"+i.uuid}),s))}static{this.\u0275fac=function(i){return new(i||v)(r.KVO(D.DSpaceObjectDataService),r.KVO(W.$),r.KVO(u.AuthorizationDataService),r.KVO(L.Bq),r.KVO(Q),r.KVO(S.ResearcherProfileDataService),r.KVO(z.I),r.KVO(X.c$),r.KVO(R.Ee),r.KVO(A.CorrectionTypeDataService))}}static{this.\u0275prov=r.jDH({token:v,factory:v.\u0275fac,providedIn:"root"})}}return v})();const Y=(v,Z,e=(0,r.WQX)(J))=>e.resolve(v,Z)}}]);