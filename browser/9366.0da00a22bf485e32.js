"use strict";(self.webpackChunkdspace_angular=self.webpackChunkdspace_angular||[]).push([[9366,2719],{82719:(R,D,i)=>{i.r(D),i.d(D,{BulkAccessConfigDataService:()=>C});var c=i(72734),h=i(41684),g=i(32473),S=i(4910),A=i(78971),p=i(54438);let C=(()=>{class u extends A.O{constructor(m,b,n,d){super("bulkaccessconditionoptions",m,b,n,d),this.requestService=m,this.rdbService=b,this.objectCache=n,this.halService=d}static{this.\u0275fac=function(b){return new(b||u)(p.KVO(g.B),p.KVO(c.o),p.KVO(h.$),p.KVO(S.Y))}}static{this.\u0275prov=p.jDH({token:u,factory:u.\u0275fac,providedIn:"root"})}}return u})()},78971:(R,D,i)=>{i.d(D,{O:()=>S});var c=i(96354),h=i(63897),g=i(80183);class S extends h.W{findByHref(p,C=!0,u=!0,...T){return super.findByHref(p,C,u,...T).pipe((0,g.qD)(),(0,c.T)(m=>{if(m.hasFailed)throw new Error("Couldn't retrieve the config");return m}))}findByName(p,C=!0,u=!0,...T){return super.findById(p,C,u,...T)}}},89366:(R,D,i)=>{i.d(D,{o:()=>re});var c=i(60177),h=i(89417),g=i(41780),S=i(63172),A=i(44668),p=i(70274),C=i(96354),u=i(96697),T=i(82719),b=(i(1716),i(80183)),n=i(16292),d=i(47978),f=i(60456),_=i(13329),k=i(52149),M=i(12866),e=i(54438);let F=(()=>{class a{transform(t){if(!t)return null;const o=new Date(t);return{year:o.getFullYear(),month:o.getMonth()+1,day:o.getDate()}}static{this.\u0275fac=function(o){return new(o||a)}}static{this.\u0275pipe=e.EJ8({name:"toDate",type:a,pure:!1,standalone:!0})}}return a})();const O=["ngForm"];function L(a,v){1&a&&(e.j41(0,"div",7),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&a&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"access-control-no-access-conditions-warning-message")," "))}function w(a,v){if(1&a&&(e.j41(0,"option",20),e.EFF(1),e.k0s()),2&a){const t=v.$implicit;e.Y8G("value",t.name),e.R7$(),e.SpI(" ",t.name," ")}}function G(a,v){if(1&a){const t=e.RV6();e.j41(0,"div",21)(1,"label",10),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"div",17)(5,"input",22,1),e.nI1(7,"toDate"),e.mxI("ngModelChange",function(s){e.eBV(t);const r=e.XpG().$implicit;return e.DH7(r.startDate,s)||(r.startDate=s),e.Njj(s)}),e.k0s(),e.j41(8,"div",23)(9,"button",24),e.bIt("click",function(){e.eBV(t);const s=e.sdS(6);return e.Njj(s.toggle())}),e.k0s()()(),e.j41(10,"small",14),e.EFF(11),e.nI1(12,"translate"),e.k0s()()}if(2&a){const t=e.XpG().$implicit;e.XpG();const o=e.sdS(1);e.R7$(),e.Mz_("for","accesscontrolstartdate-",t.id,""),e.R7$(),e.SpI(" ",e.bMT(3,11,"access-control-option-start-date")," "),e.R7$(3),e.Mz_("id","accesscontrolstartdate-",t.id,""),e.Mz_("name","startDate-",t.id,""),e.R50("ngModel",t.startDate),e.Y8G("maxDate",e.bMT(7,13,t.maxStartDate)),e.R7$(4),e.Y8G("dsBtnDisabled",o.disabled),e.R7$(2),e.SpI(" ",e.bMT(12,15,"access-control-option-start-date-note")," ")}}function $(a,v){if(1&a){const t=e.RV6();e.j41(0,"div",21)(1,"label",10),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"div",17)(5,"input",22,2),e.nI1(7,"toDate"),e.mxI("ngModelChange",function(s){e.eBV(t);const r=e.XpG().$implicit;return e.DH7(r.endDate,s)||(r.endDate=s),e.Njj(s)}),e.k0s(),e.j41(8,"div",23)(9,"button",24),e.bIt("click",function(){e.eBV(t);const s=e.sdS(6);return e.Njj(s.toggle())}),e.k0s()()(),e.j41(10,"small",14),e.EFF(11),e.nI1(12,"translate"),e.k0s()()}if(2&a){const t=e.XpG().$implicit;e.XpG();const o=e.sdS(1);e.R7$(),e.Mz_("for","accesscontrolenddate-",t.id,""),e.R7$(),e.SpI(" ",e.bMT(3,11,"access-control-option-end-date")," "),e.R7$(3),e.Mz_("id","accesscontrolenddate-",t.id,""),e.Mz_("name","endDate-",t.id,""),e.R50("ngModel",t.endDate),e.Y8G("maxDate",e.bMT(7,13,t.maxEndDate)),e.R7$(4),e.Y8G("dsBtnDisabled",o.disabled),e.R7$(2),e.SpI(" ",e.bMT(12,15,"access-control-option-end-date-note")," ")}}function N(a,v){if(1&a){const t=e.RV6();e.qex(0),e.j41(1,"div",8)(2,"div",9)(3,"div")(4,"label",10),e.EFF(5),e.nI1(6,"translate"),e.k0s(),e.j41(7,"select",11),e.mxI("ngModelChange",function(s){const r=e.eBV(t).$implicit;return e.DH7(r.itemName,s)||(r.itemName=s),e.Njj(s)}),e.bIt("ngModelChange",function(s){const r=e.eBV(t).$implicit,I=e.XpG();return e.Njj(I.accessControlChanged(r,s))}),e.nrm(8,"option",12),e.DNE(9,w,2,2,"option",13),e.k0s(),e.j41(10,"small",14),e.EFF(11),e.nI1(12,"translate"),e.k0s()(),e.DNE(13,G,13,17,"div",15)(14,$,13,17,"div",15),e.k0s(),e.j41(15,"div")(16,"span",16),e.EFF(17,"\xa0"),e.k0s(),e.j41(18,"div",17)(19,"button",18),e.nI1(20,"translate"),e.bIt("click",function(){const s=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.removeAccessControlItem(s.id))}),e.nrm(21,"i",19),e.k0s()()()(),e.bVm()}if(2&a){const t=v.$implicit,o=e.XpG(),s=e.sdS(1);e.R7$(),e.Mz_("ngModelGroup","access-control-item-",t.id,""),e.R7$(3),e.Mz_("for","accesscontroloption-",t.id,""),e.R7$(),e.SpI(" ",e.bMT(6,17,"access-control-option-label")," "),e.R7$(2),e.Mz_("id","accesscontroloption-",t.id,""),e.Mz_("name","itemName-",t.id,""),e.Y8G("disabled",s.disabled),e.R50("ngModel",t.itemName),e.R7$(2),e.Y8G("ngForOf",o.dropdownOptions),e.R7$(2),e.SpI(" ",e.bMT(12,19,"access-control-option-note")," "),e.R7$(2),e.Y8G("ngIf",t.hasStartDate),e.R7$(),e.Y8G("ngIf",t.hasEndDate),e.R7$(5),e.Y8G("dsBtnDisabled",s.disabled||1===o.form.accessControls.length),e.BMQ("aria-label",e.bMT(20,21,"access-control-remove"))}}let P=(()=>{class a{constructor(){this.dropdownOptions=[],this.form={accessControls:[E()]},this.formDisabled=!0,this.disable=()=>{this.ngForm.form.disable(),this.formDisabled=!0},this.enable=()=>{this.ngForm.form.enable(),this.formDisabled=!1}}ngOnInit(){this.disable()}get allControlsAreEmpty(){return this.form.accessControls.every(t=>null===t.itemName||""===t.itemName)}get showWarning(){return"replace"===this.mode&&this.allControlsAreEmpty&&!this.formDisabled}addAccessControlItem(t=null){this.form.accessControls=[...this.form.accessControls,{...E(),itemName:t}]}removeAccessControlItem(t){this.form.accessControls=this.form.accessControls.filter(o=>o.id!==t)}getValue(){return this.form.accessControls.filter(t=>null!==t.itemName&&""!==t.itemName).map(t=>({name:t.itemName,startDate:t.startDate?(0,M.Sd)(t.startDate):null,endDate:t.endDate?(0,M.Sd)(t.endDate):null}))}reset(){this.form.accessControls=[],this.addAccessControlItem(),this.disable()}accessControlChanged(t,o){const s=this.dropdownOptions.find(r=>r.name===o);t.startDate=null,t.endDate=null,t.hasStartDate=s?.hasStartDate||!1,t.hasEndDate=s?.hasEndDate||!1,t.maxStartDate=s?.maxStartDate||null,t.maxEndDate=s?.maxEndDate||null}trackById(t,o){return o.id}static{this.\u0275fac=function(o){return new(o||a)}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["ds-access-control-array-form"]],viewQuery:function(o,s){if(1&o&&e.GBs(O,7),2&o){let r;e.mGM(r=e.lsd())&&(s.ngForm=r.first)}},inputs:{dropdownOptions:"dropdownOptions",mode:"mode",type:"type"},exportAs:["accessControlArrayForm"],standalone:!0,features:[e.aNF],decls:8,vars:9,consts:[["ngForm","ngForm"],["d","ngbDatepicker"],["d1","ngbDatepicker"],["class","alert alert-warning",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],["type","button",1,"btn","btn-outline-primary","mt-3",3,"click","id","dsBtnDisabled"],[1,"fas","fa-plus"],[1,"alert","alert-warning"],[1,"access-control-item","mt-3",3,"ngModelGroup"],[1,"d-flex","flex-column"],[3,"for"],[1,"form-control",3,"ngModelChange","id","disabled","ngModel","name"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"form-text","text-muted"],["class","mt-3",4,"ngIf"],["aria-hidden","true",1,"mb-2","d-inline-block"],[1,"input-group"],["type","button",1,"btn","btn-outline-danger",3,"click","dsBtnDisabled"],[1,"fas","fa-trash"],[3,"value"],[1,"mt-3"],["placeholder","yyyy-mm-dd","ngbDatepicker","","placement","top-start top-end bottom-start bottom-end",1,"form-control",3,"ngModelChange","id","ngModel","name","maxDate"],[1,"input-group-append"],["type","button",1,"btn","btn-outline-secondary","fas","fa-calendar",3,"click","dsBtnDisabled"]],template:function(o,s){if(1&o){const r=e.RV6();e.j41(0,"form",null,0),e.DNE(2,L,3,3,"div",3)(3,N,22,23,"ng-container",4),e.j41(4,"button",5),e.bIt("click",function(){return e.eBV(r),e.Njj(s.addAccessControlItem())}),e.nrm(5,"i",6),e.EFF(6),e.nI1(7,"translate"),e.k0s()()}if(2&o){const r=e.sdS(1);e.R7$(2),e.Y8G("ngIf",s.showWarning),e.R7$(),e.Y8G("ngForOf",s.form.accessControls)("ngForTrackBy",s.trackById),e.R7$(),e.Mz_("id","add-btn-",s.type,""),e.Y8G("dsBtnDisabled",r.disabled),e.R7$(2),e.SpI(" ",e.bMT(7,7,"access-control-add-more")," ")}},dependencies:[h.YN,h.qT,h.xH,h.y7,h.me,h.wz,h.BC,h.cb,h.vS,h.Y4,h.cV,c.bT,c.pM,k.IQ,k.cw,g.h,g.D9,F,f.A],styles:[".access-control-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 50px;grid-gap:10px;padding-bottom:15px;border-bottom:2px dotted gray}"]})}}return a})();const E=()=>({id:V(),itemName:null,startDate:null,hasStartDate:!1,maxStartDate:null,endDate:null,hasEndDate:!1,maxEndDate:null}),V=()=>Math.floor(1e6*Math.random());var U=i(54028),x=i(84412),Y=i(26292),X=i(42578),K=i(22978),W=(i(88318),i(82777)),z=i(67560),H=i(23401);const J=a=>({repeatable:!0,listId:a});function Q(a,v){if(1&a){const t=e.RV6();e.j41(0,"ds-viewable-collection",10),e.bIt("pageChange",function(s){e.eBV(t);const r=e.XpG(2);return e.Njj(r.loadForPage(s))}),e.k0s()}if(2&a){const t=e.XpG().ngIf,o=e.XpG();e.Y8G("config",o.paginationConfig)("context",o.context)("objects",t)("selectable",!0)("selectionConfig",e.eq3(6,J,o.LIST_ID))("showPaginator",!0)}}function Z(a,v){1&a&&(e.j41(0,"div",11),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&a&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"access-control-select-bitstreams-modal.no-items")," "))}function q(a,v){if(1&a&&(e.qex(0),e.DNE(1,Q,1,8,"ds-viewable-collection",8)(2,Z,3,3,"div",9),e.bVm()),2&a){const t=v.ngIf;e.R7$(),e.Y8G("ngIf",t.payload.page.length>0),e.R7$(),e.Y8G("ngIf",t&&0===t.payload.page.length)}}const B="item-access-control-select-bitstreams";let ee=(()=>{class a{constructor(t,o,s,r){this.bitstreamService=t,this.paginationService=o,this.translateService=s,this.activeModal=r,this.LIST_ID=B,this.selectedBitstreams=[],this.data$=new x.t(null),this.pageSize=5,this.context=Y.o.Bitstream}ngOnInit(){this.loadForPage(1),this.paginationConfig=new H.W,this.paginationConfig.id="iacsbm",this.paginationConfig.currentPage=1,(0,W.a4)(this.pageSize)&&(this.paginationConfig.pageSize=this.pageSize)}loadForPage(t){this.bitstreamService.findAllByItemAndBundleName(this.item,"ORIGINAL",{currentPage:t},!1).pipe((0,b.qD)()).subscribe(this.data$)}static{this.\u0275fac=function(o){return new(o||a)(e.rXU(X.BitstreamDataService),e.rXU(K.m),e.rXU(g.c$),e.rXU(k.Lw))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["ds-item-access-control-select-bitstreams-modal"]],inputs:{item:"item",selectedBitstreams:"selectedBitstreams"},standalone:!0,features:[e.aNF],decls:14,vars:9,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"],[3,"config","context","objects","selectable","selectionConfig","showPaginator","pageChange",4,"ngIf"],["class","alert alert-info w-100","role","alert",4,"ngIf"],[3,"pageChange","config","context","objects","selectable","selectionConfig","showPaginator"],["role","alert",1,"alert","alert-info","w-100"]],template:function(o,s){1&o&&(e.j41(0,"div",0)(1,"h4",1),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"button",2),e.bIt("click",function(){return s.activeModal.dismiss("Cross click")}),e.j41(5,"span",3),e.EFF(6,"\xd7"),e.k0s()()(),e.j41(7,"div",4),e.DNE(8,q,3,2,"ng-container",5),e.nI1(9,"async"),e.k0s(),e.j41(10,"div",6)(11,"button",7),e.bIt("click",function(){return s.activeModal.close("Close click")}),e.EFF(12),e.nI1(13,"translate"),e.k0s()()),2&o&&(e.R7$(2),e.SpI(" ",e.bMT(3,3,"access-control-select-bitstreams-modal.title")," "),e.R7$(6),e.Y8G("ngIf",e.bMT(9,5,s.data$)),e.R7$(4),e.SpI(" ",e.bMT(13,7,"access-control-select-bitstreams-modal.close")," "))},dependencies:[c.bT,z.h,c.Jj,g.h,g.D9]})}}return a})();const te=["bitstreamAccessCmp"],se=["itemAccessCmp"],j=()=>[];function ne(a,v){if(1&a&&e.nrm(0,"ds-alert",29),2&a){const t=e.XpG();e.Y8G("type",t.AlertType.Info)("content",t.titleMessage)}}function oe(a,v){if(1&a){const t=e.RV6();e.j41(0,"button",37),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const s=e.XpG(2);return e.Njj(s.openSelectBitstreamsModal(s.itemRD.payload))}),e.nrm(2,"i",38),e.k0s()}if(2&a){const t=e.XpG(2);e.Y8G("dsBtnDisabled",!t.state.bitstream.toggleStatus||"selected"!==t.state.bitstream.changesLimit),e.BMQ("aria-label",e.bMT(1,2,"access-control-bitstreams-select"))}}function ae(a,v){if(1&a){const t=e.RV6();e.j41(0,"div",11)(1,"fieldset",30)(2,"legend",31),e.EFF(3),e.nI1(4,"translate"),e.k0s(),e.j41(5,"div",14)(6,"input",32),e.mxI("ngModelChange",function(s){e.eBV(t);const r=e.XpG();return e.DH7(r.state.bitstream.changesLimit,s)||(r.state.bitstream.changesLimit=s),e.Njj(s)}),e.k0s(),e.j41(7,"label",33),e.EFF(8),e.nI1(9,"translate"),e.k0s()(),e.j41(10,"div",14)(11,"input",34),e.mxI("ngModelChange",function(s){e.eBV(t);const r=e.XpG();return e.DH7(r.state.bitstream.changesLimit,s)||(r.state.bitstream.changesLimit=s),e.Njj(s)}),e.k0s(),e.j41(12,"label",35),e.EFF(13),e.nI1(14,"translate"),e.DNE(15,oe,3,4,"button",36),e.k0s()()()()}if(2&a){const t=e.XpG();e.R7$(3),e.SpI(" ",e.bMT(4,9,"access-control-limit-to-specific")," "),e.R7$(3),e.Y8G("disabled",!t.state.bitstream.toggleStatus),e.R50("ngModel",t.state.bitstream.changesLimit),e.R7$(2),e.SpI(" ",e.bMT(9,11,"access-control-process-all-bitstreams")," "),e.R7$(3),e.Y8G("disabled",!t.state.bitstream.toggleStatus),e.R50("ngModel",t.state.bitstream.changesLimit),e.R7$(2),e.Lme(" ",t.state.bitstream.selectedBitstreams.length," ",e.bMT(14,13,"access-control-bitstreams-selected")," "),e.R7$(2),e.Y8G("ngIf",t.itemRD)}}function ie(a,v){1&a&&e.nrm(0,"hr")}function ce(a,v){if(1&a){const t=e.RV6();e.j41(0,"div",39)(1,"button",40),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.reset())}),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"button",41),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.submit())}),e.EFF(5),e.nI1(6,"translate"),e.k0s()()}if(2&a){const t=e.XpG();e.R7$(2),e.SpI(" ",e.bMT(3,3,"access-control-cancel")," "),e.R7$(2),e.Y8G("dsBtnDisabled",!t.state.item.toggleStatus&&!t.state.bitstream.toggleStatus),e.R7$(),e.SpI(" ",e.bMT(6,5,"access-control-execute")," ")}}let re=(()=>{class a{constructor(t,o,s,r,I){this.bulkAccessConfigService=t,this.bulkAccessControlService=o,this.selectableListService=s,this.modalService=r,this.cdr=I,this.showLimitToSpecificBitstreams=!1,this.titleMessage="",this.showSubmit=!0,this.AlertType=d.v,this.state={item:{toggleStatus:!1,accessMode:"replace"},bitstream:{toggleStatus:!1,accessMode:"replace",changesLimit:"all",selectedBitstreams:[]}},this.dropdownData$=this.bulkAccessConfigService.findByName("default").pipe((0,b.qD)(),(0,C.T)(l=>l.hasSucceeded?l.payload:null),(0,A.t)({refCount:!1,bufferSize:1}))}getFormValue(){return console.log({bitstream:this.bitstreamAccessCmp.getValue(),item:this.itemAccessCmp.getValue(),state:this.state}),{bitstream:this.bitstreamAccessCmp.getValue(),item:this.itemAccessCmp.getValue(),state:this.state}}reset(){this.bitstreamAccessCmp.reset(),this.itemAccessCmp.reset(),this.state={item:{toggleStatus:!1,accessMode:"replace"},bitstream:{toggleStatus:!1,accessMode:"replace",changesLimit:"all",selectedBitstreams:[]}}}submit(){const t=this.bitstreamAccessCmp.getValue(),o=this.itemAccessCmp.getValue(),{file:s}=this.bulkAccessControlService.createPayloadFile({bitstreamAccess:t,itemAccess:o,state:this.state});this.bulkAccessControlService.executeScript([this.itemRD.payload.uuid],s).pipe((0,u.s)(1)).subscribe(r=>{console.log("success",r)})}handleStatusChange(t,o){"bitstream"===t?o?this.bitstreamAccessCmp.enable():this.bitstreamAccessCmp.disable():"item"===t&&(o?this.itemAccessCmp.enable():this.itemAccessCmp.disable())}openSelectBitstreamsModal(t){const o=this.modalService.open(ee);o.componentInstance.selectedBitstreams=this.state.bitstream.selectedBitstreams,o.componentInstance.item=t,o.closed.pipe((0,p.H)(()=>this.selectableListService.getSelectableList(B)),(0,u.s)(1)).subscribe(s=>{this.state.bitstream.selectedBitstreams=s?.selection||[],this.cdr.detectChanges()})}ngOnDestroy(){this.selectableListService.deselectAll(B)}static{this.\u0275fac=function(o){return new(o||a)(e.rXU(T.BulkAccessConfigDataService),e.rXU(U.r),e.rXU(_.K),e.rXU(k.Bq),e.rXU(e.gRc))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["ds-access-control-form-container"]],viewQuery:function(o,s){if(1&o&&(e.GBs(te,7),e.GBs(se,7)),2&o){let r;e.mGM(r=e.lsd())&&(s.bitstreamAccessCmp=r.first),e.mGM(r=e.lsd())&&(s.itemAccessCmp=r.first)}},inputs:{showLimitToSpecificBitstreams:"showLimitToSpecificBitstreams",titleMessage:"titleMessage",itemRD:"itemRD",showSubmit:"showSubmit"},exportAs:["dsAccessControlForm"],standalone:!0,features:[e.aNF],decls:68,vars:62,consts:[["itemAccessCmp",""],["bitstreamAccessCmp",""],[1,"container"],[1,"card","border-0"],[1,"card-body"],["class","d-block pb-3",3,"type","content",4,"ngIf"],[1,"row"],[1,"col-12","col-md-6","border-right","d-flex","flex-column","justify-content-between"],[1,"d-flex","align-items-center"],[1,"h3","mb-0","mr-4"],[3,"ngModelChange","ariaLabel","ngModel"],[1,"row","mt-3"],[1,"h4","col-12","col-md-3"],[1,"col-12","col-md-8"],[1,"form-check"],["type","radio","name","itemMode","id","itemReplace","value","replace",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","itemReplace",1,"form-check-label"],["type","radio","name","itemMode","id","itemAdd","value","add",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","itemAdd",1,"form-check-label"],[1,"h4","mt-3"],[3,"type","mode","dropdownOptions"],[1,"col-12","col-md-6","d-flex","flex-column","justify-content-between"],["class","row mt-3",4,"ngIf"],["type","radio","name","bitstreamMode","id","bitstreamReplace","value","replace",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","bitstreamReplace",1,"form-check-label"],["type","radio","name","bitstreamMode","id","bitstreamAdd","value","add",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","bitstreamAdd",1,"form-check-label"],[4,"ngIf"],["class","d-flex justify-content-end",4,"ngIf"],[1,"d-block","pb-3",3,"type","content"],[1,"col-12"],[1,"h4"],["type","radio","name","changesLimit","id","processAll","value","all",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","processAll",1,"form-check-label"],["type","radio","name","changesLimit","id","processSelected","value","selected",1,"form-check-input","mt-2",3,"ngModelChange","disabled","ngModel"],["for","processSelected",1,"form-check-label"],["class","btn btn-outline-dark border-0","type","button",3,"dsBtnDisabled","click",4,"ngIf"],["type","button",1,"btn","btn-outline-dark","border-0",3,"click","dsBtnDisabled"],[1,"fa","fa-search"],[1,"d-flex","justify-content-end"],["type","button",1,"btn","btn-outline-primary","mr-3",3,"click"],["type","submit",1,"btn","btn-primary",3,"click","dsBtnDisabled"]],template:function(o,s){if(1&o){const r=e.RV6();e.j41(0,"div",2)(1,"div",3)(2,"div",4),e.DNE(3,ne,1,2,"ds-alert",5),e.j41(4,"div",6)(5,"div",7)(6,"div")(7,"div",8)(8,"h2",9),e.EFF(9),e.nI1(10,"translate"),e.k0s(),e.j41(11,"ui-switch",10),e.nI1(12,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(r),e.DH7(s.state.item.toggleStatus,l)||(s.state.item.toggleStatus=l),e.Njj(l)}),e.bIt("ngModelChange",function(l){return e.eBV(r),e.Njj(s.handleStatusChange("item",l))}),e.k0s()(),e.j41(13,"fieldset",11)(14,"legend",12),e.EFF(15),e.nI1(16,"translate"),e.k0s(),e.j41(17,"div",13)(18,"div",14)(19,"input",15),e.mxI("ngModelChange",function(l){return e.eBV(r),e.DH7(s.state.item.accessMode,l)||(s.state.item.accessMode=l),e.Njj(l)}),e.k0s(),e.j41(20,"label",16),e.EFF(21),e.nI1(22,"translate"),e.k0s()(),e.j41(23,"div",14)(24,"input",17),e.mxI("ngModelChange",function(l){return e.eBV(r),e.DH7(s.state.item.accessMode,l)||(s.state.item.accessMode=l),e.Njj(l)}),e.k0s(),e.j41(25,"label",18),e.EFF(26),e.nI1(27,"translate"),e.k0s()()()()(),e.j41(28,"div")(29,"h3",19),e.EFF(30),e.nI1(31,"translate"),e.k0s(),e.nrm(32,"ds-access-control-array-form",20,0),e.nI1(34,"async"),e.k0s()(),e.j41(35,"div",21)(36,"div")(37,"div",8)(38,"h2",9),e.EFF(39),e.nI1(40,"translate"),e.k0s(),e.j41(41,"ui-switch",10),e.nI1(42,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(r),e.DH7(s.state.bitstream.toggleStatus,l)||(s.state.bitstream.toggleStatus=l),e.Njj(l)}),e.bIt("ngModelChange",function(l){return e.eBV(r),e.Njj(s.handleStatusChange("bitstream",l))}),e.k0s()(),e.DNE(43,ae,16,15,"div",22),e.k0s(),e.j41(44,"fieldset",11)(45,"legend",12),e.EFF(46),e.nI1(47,"translate"),e.k0s(),e.j41(48,"div",13)(49,"div",14)(50,"input",23),e.mxI("ngModelChange",function(l){return e.eBV(r),e.DH7(s.state.bitstream.accessMode,l)||(s.state.bitstream.accessMode=l),e.Njj(l)}),e.k0s(),e.j41(51,"label",24),e.EFF(52),e.nI1(53,"translate"),e.k0s()(),e.j41(54,"div",14)(55,"input",25),e.mxI("ngModelChange",function(l){return e.eBV(r),e.DH7(s.state.bitstream.accessMode,l)||(s.state.bitstream.accessMode=l),e.Njj(l)}),e.k0s(),e.j41(56,"label",26),e.EFF(57),e.nI1(58,"translate"),e.k0s()()()(),e.j41(59,"div")(60,"h3",19),e.EFF(61),e.nI1(62,"translate"),e.k0s(),e.nrm(63,"ds-access-control-array-form",20,1),e.nI1(65,"async"),e.k0s()()(),e.DNE(66,ie,1,0,"hr",27)(67,ce,7,7,"div",28),e.k0s()()()}if(2&o){let r,I;e.R7$(3),e.Y8G("ngIf",s.titleMessage),e.R7$(6),e.SpI(" ",e.bMT(10,32,"access-control-item-header-toggle")," "),e.R7$(2),e.Y8G("ariaLabel",e.bMT(12,34,s.state.bitstream.toggleStatus?"access-control-item-toggle.disable":"access-control-item-toggle.enable")),e.R50("ngModel",s.state.item.toggleStatus),e.R7$(4),e.SpI(" ",e.bMT(16,36,"access-control-mode")," "),e.R7$(4),e.Y8G("disabled",!s.state.item.toggleStatus),e.R50("ngModel",s.state.item.accessMode),e.R7$(2),e.SpI(" ",e.bMT(22,38,"access-control-replace-all")," "),e.R7$(3),e.Y8G("disabled",!s.state.item.toggleStatus),e.R50("ngModel",s.state.item.accessMode),e.R7$(2),e.SpI(" ",e.bMT(27,40,"access-control-add-to-existing")," "),e.R7$(4),e.JRh(e.bMT(31,42,"access-control-access-conditions")),e.R7$(2),e.Y8G("type","item")("mode",s.state.item.accessMode)("dropdownOptions",(null==(r=e.bMT(34,44,s.dropdownData$))?null:r.itemAccessConditionOptions)||e.lJ4(60,j)),e.R7$(7),e.SpI(" ",e.bMT(40,46,"access-control-bitstream-header-toggle")," "),e.R7$(2),e.Y8G("ariaLabel",e.bMT(42,48,s.state.bitstream.toggleStatus?"access-control-bitstream-toggle.disable":"access-control-bitstream-toggle.enable")),e.R50("ngModel",s.state.bitstream.toggleStatus),e.R7$(2),e.Y8G("ngIf",s.showLimitToSpecificBitstreams),e.R7$(3),e.SpI(" ",e.bMT(47,50,"access-control-mode")," "),e.R7$(4),e.Y8G("disabled",!s.state.bitstream.toggleStatus),e.R50("ngModel",s.state.bitstream.accessMode),e.R7$(2),e.SpI(" ",e.bMT(53,52,"access-control-replace-all")," "),e.R7$(3),e.Y8G("disabled",!s.state.bitstream.toggleStatus),e.R50("ngModel",s.state.bitstream.accessMode),e.R7$(2),e.SpI(" ",e.bMT(58,54,"access-control-add-to-existing")," "),e.R7$(4),e.JRh(e.bMT(62,56,"access-control-access-conditions")),e.R7$(2),e.Y8G("type","bitstream")("mode",s.state.bitstream.accessMode)("dropdownOptions",(null==(I=e.bMT(65,58,s.dropdownData$))?null:I.bitstreamAccessConditionOptions)||e.lJ4(61,j)),e.R7$(3),e.Y8G("ngIf",s.showSubmit),e.R7$(),e.Y8G("ngIf",s.showSubmit)}},dependencies:[c.bT,n.C,S.z,h.me,h.Fm,h.BC,h.vS,S.S,h.YN,P,c.Jj,g.h,g.D9,f.A]})}}return a})()},54028:(R,D,i)=>{i.d(D,{r:()=>m});var c=i(96354),h=i(32736),g=i(80183),S=i(1504),A=i(82777),p=i(39806),C=i(54438),u=i(7901),T=i(41780);let m=(()=>{class n{constructor(f,_,k,M){this.notificationsService=f,this.router=_,this.scriptService=k,this.translationService=M}createPayloadFile(f){const _=b(f),k=new Blob([JSON.stringify(_,null,2)],{type:"application/json"}),M=new File([k],"data.json",{type:"application/json"});return{url:URL.createObjectURL(M),file:M}}executeScript(f,_){console.log("execute",{uuids:f,file:_});const k=[{name:"-f",value:_.name}];return f.forEach(M=>{k.push({name:"-u",value:M})}),this.scriptService.invoke("bulk-access-control",k,[_]).pipe((0,g.qD)(),(0,c.T)(M=>{if(M.hasSucceeded){const e=this.translationService.get("process.new.notification.success.title"),F=this.translationService.get("process.new.notification.success.content");return this.notificationsService.success(e,F),(0,A.hj)(M.payload)&&this.router.navigateByUrl((0,S.yJ)(M.payload.processId)),!0}{const e=this.translationService.get("process.new.notification.error.title"),F=this.translationService.get("process.new.notification.error.content");return this.notificationsService.error(e,F),!1}}))}static{this.\u0275fac=function(_){return new(_||n)(C.KVO(p.I),C.KVO(u.Ix),C.KVO(h.ScriptDataService),C.KVO(T.c$))}}static{this.\u0275prov=C.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const b=n=>{const d={},_=n.state.bitstream.toggleStatus;if(n.state.item.toggleStatus&&(d.item={mode:n.state.item.accessMode,accessConditions:n.itemAccess}),_){const k={uuid:[]};_&&"selected"===n.state.bitstream.changesLimit&&(k.uuid=n.state.bitstream.selectedBitstreams.map(M=>M.id)),d.bitstream={constraints:k,mode:n.state.bitstream.accessMode,accessConditions:n.bitstreamAccess}}return d}},63172:(R,D,i)=>{i.d(D,{S:()=>u,z:()=>T});var c=i(54438),h=i(89417),g=i(60177);const S=["*"];function A(m,b){if(1&m&&(c.j41(0,"label",2)(1,"span",3),c.EFF(2),c.k0s(),c.j41(3,"span",4),c.EFF(4),c.k0s()()),2&m){const n=c.XpG();c.R7$(),c.xc7("color",n.getColor("checkedTextColor")),c.BMQ("aria-label",n.checkedLabel),c.R7$(),c.JRh(n.checkedLabel),c.R7$(),c.xc7("color",n.getColor("uncheckedTextColor")),c.BMQ("aria-label",n.uncheckedLabel),c.R7$(),c.JRh(n.uncheckedLabel)}}const p=new c.nKC("UI_SWITCH_OPTIONS"),C={provide:h.kq,useExisting:(0,c.Rfq)(()=>u),multi:!0};let u=(()=>{class m{constructor(n={},d){this.cdr=d,this.change=new c.bkB,this.changeEvent=new c.bkB,this.valueChange=new c.bkB,this.onTouchedCallback=f=>{},this.onChangeCallback=f=>{},this.size=n&&n.size||"medium",this.color=n&&n.color,this.switchOffColor=n&&n.switchOffColor,this.switchColor=n&&n.switchColor,this.defaultBgColor=n&&n.defaultBgColor,this.defaultBoColor=n&&n.defaultBoColor,this.checkedLabel=n&&n.checkedLabel,this.uncheckedLabel=n&&n.uncheckedLabel,this.checkedTextColor=n&&n.checkedTextColor,this.uncheckedTextColor=n&&n.uncheckedTextColor}set checked(n){this._checked=!1!==n}get checked(){return this._checked}set disabled(n){this._disabled=!1!==n}get disabled(){return this._disabled}set reverse(n){this._reverse=!1!==n}get reverse(){return this._reverse}set loading(n){this._loading=!1!==n}get loading(){return this._loading}getColor(n=""){return"borderColor"===n?this.defaultBoColor:"switchColor"===n?this.reverse?this.checked&&this.switchOffColor||this.switchColor:this.checked?this.switchColor:this.switchOffColor||this.switchColor:"checkedTextColor"===n?this.reverse?this.uncheckedTextColor:this.checkedTextColor:"uncheckedTextColor"===n?this.reverse?this.checkedTextColor:this.uncheckedTextColor:this.reverse?this.checked?this.defaultBgColor:this.color:this.checked?this.color:this.defaultBgColor}onClick(n){this.disabled||(this.checked=!this.checked,this.change.emit(this.checked),this.valueChange.emit(this.checked),this.changeEvent.emit(n),this.onChangeCallback(this.checked),this.onTouchedCallback(this.checked),this.cdr.markForCheck())}onToggle(n){this.disabled||(this.beforeChange?this._beforeChange=this.beforeChange.subscribe(d=>{d&&this.onClick(n)}):this.onClick(n))}writeValue(n){n!==this.checked&&(this.checked=!!n),this.onChangeCallback(this.checked),this.cdr&&this.cdr.markForCheck()}registerOnChange(n){this.onChangeCallback=n}registerOnTouched(n){this.onTouchedCallback=n}setDisabledState(n){this.disabled=n}ngOnDestroy(){this._beforeChange&&this._beforeChange.unsubscribe()}}return m.\u0275fac=function(n){return new(n||m)(c.rXU(p,8),c.rXU(c.gRc))},m.\u0275cmp=c.VBU({type:m,selectors:[["ui-switch"]],hostBindings:function(n,d){1&n&&c.bIt("click",function(_){return d.onToggle(_)})},inputs:{size:"size",color:"color",switchOffColor:"switchOffColor",switchColor:"switchColor",defaultBgColor:"defaultBgColor",defaultBoColor:"defaultBoColor",checkedLabel:"checkedLabel",uncheckedLabel:"uncheckedLabel",checkedTextColor:"checkedTextColor",uncheckedTextColor:"uncheckedTextColor",beforeChange:"beforeChange",ariaLabel:"ariaLabel",checked:"checked",disabled:"disabled",reverse:"reverse",loading:"loading"},outputs:{change:"change",changeEvent:"changeEvent",valueChange:"valueChange"},features:[c.Jv_([C])],ngContentSelectors:S,decls:4,vars:21,consts:[["type","button","role","switch",1,"switch"],["class","switch-pane",4,"ngIf"],[1,"switch-pane"],[1,"switch-label-checked"],[1,"switch-label-unchecked"]],template:function(n,d){1&n&&(c.NAR(),c.j41(0,"button",0),c.DNE(1,A,5,8,"label",1),c.j41(2,"small"),c.SdG(3),c.k0s()()),2&n&&(c.xc7("background-color",d.getColor())("border-color",d.getColor("borderColor")),c.AVh("checked",d.checked)("disabled",d.disabled)("loading",d.loading)("switch-large","large"===d.size)("switch-medium","medium"===d.size)("switch-small","small"===d.size),c.BMQ("aria-checked",d.checked)("aria-label",d.ariaLabel),c.R7$(),c.Y8G("ngIf",d.checkedLabel||d.uncheckedLabel),c.R7$(),c.xc7("background",d.getColor("switchColor")))},dependencies:[g.bT],encapsulation:2}),m})(),T=(()=>{class m{static forRoot(n){return{ngModule:m,providers:[{provide:p,useValue:n||{}}]}}}return m.\u0275fac=function(n){return new(n||m)},m.\u0275mod=c.$C({type:m}),m.\u0275inj=c.G2t({imports:[g.MD,h.YN,h.YN]}),m})()}}]);